import{c as r,l as o,s as c,b,r as s,n as y,d as E,e as f,f as A,g as C}from"./assets/refs-8ddcb271.js";import{a as u}from"./assets/vendor-b325e1ef.js";async function P(t){try{return(await u({url:`${r.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(e){return e}}async function Y(t){try{return(await u({url:`${r.BASE_URL}/products/${t}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function m(t){try{let e=null;return t&&(e={limit:t}),(await u({url:`${r.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(e){return e}}async function v(){try{return(await u({url:`${r.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}async function k(){try{return(await u({url:`${r.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}const d=o(r.LOCAL_CART_KEY)??[],h=async t=>{const{id:e}=t.target.closest(".js-card").dataset,a=await Y(e);d.some(({_id:i})=>i===a._id)||(d.push(a),c(r.LOCAL_CART_KEY,d),t.target.closest(".js-cart").innerHTML=`<button class="btn-check js-cart" type="button">
   <svg class="icon-check" width="18" height="18">
                               <use href="${b}#check"></use>
                           </svg>
                         </button>`)},l=async t=>{const e=await P(t);if(!e.results.length){y(s.productList);return}c(r.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),s.productList.innerHTML=E(e.results)},w=t=>{t.preventDefault(),t.target.closest(".js-cart")&&h(t),t.target.classList.contains("js-info")&&openModal(t)};s.productList.addEventListener("click",w);let g=[];const R=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],T=async()=>{g=[...await k(),"Show_all"];const e=f(g);s.categoryField.insertAdjacentHTML("beforeend",e),s.abcField.innerHTML=A(R)},S=t=>{const e=t.target.value,a=o(r.LOCAL_QUERY_KEY);e==="Show_all"?a.category=null:a.category=e,c(r.LOCAL_QUERY_KEY,a);const n=o(r.LOCAL_QUERY_KEY);l(n)},U=t=>{t.preventDefault();const e=s.searchField.value,a=o(r.LOCAL_QUERY_KEY);e?a.keyword=e:a.keyword=null,c(r.LOCAL_QUERY_KEY,a);const n=o(r.LOCAL_QUERY_KEY);l(n)},Q=async t=>{const e=t.target.value,a=o(r.LOCAL_QUERY_KEY);a.sort=e,c(r.LOCAL_QUERY_KEY,a);const n=o(r.LOCAL_QUERY_KEY),i=n.sort,p=O(i),_=await j(n,p);K(_)},O=t=>{let e={};switch(t){case"alphabetical":e="&byABC=true";break;case"reverse-alphabetical":e="&byABC=false";break;case"cheap":e="&byPrice=true";break;case"expensive":e="&byPrice=false";break;case"popular":e="&byPopularity=false";break;case"not-popular":e="&byPopularity=true";break}return e};async function j(t,e){try{return(await u({url:`${r.BASE_URL}/products?${e}`,method:"GET",header:{"Content-Type":"application/json"},params:t})).data}catch(a){return a}}const K=async t=>{if(!t.results.length){y(s.productList);return}c(r.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages}),s.productList.innerHTML=E(t.results)},M=t=>{if(t.target.value===""){const e=o(r.LOCAL_QUERY_KEY);e.keyword=null,c(r.LOCAL_QUERY_KEY,e);const a=o(r.LOCAL_QUERY_KEY);l(a)}};s.form.addEventListener("submit",U);s.categoryField.addEventListener("change",S);s.abcField.addEventListener("change",Q);s.searchField.addEventListener("input",M);const L=document.querySelector(".popular_products_list");console.dir(L);L.addEventListener("click",F);async function $(){const t=await m();if(!t.length){notFoundMarkup(s.popularProductList);return}c(r.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const e=C(t);L.insertAdjacentHTML("beforeend",e)}function F(t){t.preventDefault(),t.target.closest(".js-cart")&&h(t),t.target.classList.contains("js-info")&&openModal(t)}const D=async()=>{const t=await v(),e=G(t.slice(0,2));s.dicsProd.innerHTML=e},G=t=>t.map(({img:e,name:a,price:n,_id:i,is10PercentOff:p})=>{if(p)return`
        <li class="discount-product-element">
        <div class="discount-product-img-wrapper">
        <img class="discount-product-img" src="${e}" alt="${a}">
        </div>
        
        <div class="discount-product-descr">
         <div class="discount-product-name-wrapper">
           <h3 class="discount-product-name">${a}</h3>
          </div>
         <div class="discount-product-price-wrapper">
          <p class="discount-product-price">$${n}</p>
          <button class="discount-product-btn" type="button">add</button>
          </div>
        </div>
        
        </li>`}).join(""),B=()=>{};s.discProdList.addEventListener("click",B());c(r.LOCAL_QUERY_KEY,r.INIT_QUERY);const q=o(r.LOCAL_QUERY_KEY)??[];T();l(q);$();D();
//# sourceMappingURL=commonHelpers2.js.map
