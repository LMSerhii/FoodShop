import{c as a,l as o,s as l,b as S,r,d as L,n as b,e as j,f as N,g as F,h as B}from"./assets/refs-64b9390c.js";import{a as d,i as O,P as w,S as Y}from"./assets/vendor-38dd3e46.js";async function k(e){try{return(await d({url:`${a.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(t){return t}}async function T(e){try{return(await d({url:`${a.BASE_URL}/products/${e}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){console.log(t)}}async function $(e){try{let t=null;return e&&(t={limit:e}),(await d({url:`${a.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(t){return t}}async function D(){try{return(await d({url:`${a.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function G(){try{return(await d({url:`${a.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}const p=o(a.LOCAL_CART_KEY)??[],R=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await T(t);p.some(({_id:c})=>c===s._id)||(p.push(s),l(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${S}#check"></use>
                    </svg>
                </button>`,O.success({title:"OK",message:"Added to cart!"}))},H=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await T(t);p.some(({_id:c})=>c===s._id)||(p.push(s),l(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="popular-card-btn" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${S}#check"></use>
                    </svg>
                </button>`,O.success({title:"OK",message:"Added to cart!"}))};let g;const q=window.matchMedia("(min-width: 768px)"),M=e=>{e.matches?(g=4,P()):(g=2,P())};q.addEventListener("change",M);function P(){if(!(o(a.PAGES)??{}).length)return;const t=o(a.PAGES).page,s=o(a.PAGES).perPage,n=o(a.PAGES).totalPages;new w(r.paginationContainer,{page:t,totalItems:s*n,itemsPerPage:s,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(u){const C=JSON.parse(localStorage.getItem("pages"));C.page=u.page,localStorage.setItem("pages",JSON.stringify(C));const K=JSON.parse(localStorage.getItem("pages")),m=o(a.LOCAL_QUERY_KEY);m.page=K.page,l(a.LOCAL_QUERY_KEY,m);const I=o(a.LOCAL_QUERY_KEY);v(I)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}function Q(){new w(r.paginationContainer,{page:a.INIT_QUERY.page,totalItems:o("pages").perPage*o("pages").totalPages,itemsPerPage:o("pages").perPage,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const n=JSON.parse(localStorage.getItem("pages"));n.page=s.page,localStorage.setItem("pages",JSON.stringify(n));const c=JSON.parse(localStorage.getItem("pages")),i=o(a.LOCAL_QUERY_KEY);i.page=c.page,l(a.LOCAL_QUERY_KEY,i);const u=o(a.LOCAL_QUERY_KEY);v(u)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}async function v(e){const t=await k(e);if(!t.results.length){notFoundMarkup(r.productList);return}r.productList.innerHTML=L(t.results)}const y=e=>{const t=o(a.LOCAL_CART_KEY)??[];return e.map(n=>t.some(({_id:i})=>i===n._id)?(n.isChecked=!0,n):(n.isChecked=!1,n))},U=async e=>{const t=await k(e);if(!t.results.length){b(r.productList);return}l(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const s=y(t.results);r.productList.innerHTML=L(s),Q()},J=e=>{e.preventDefault(),e.target.closest(".js-cart")&&R(e),e.target.classList.contains("js-info")&&openModal(e)};r.productList.addEventListener("click",J);new Y({select:"#abcField",settings:{showSearch:!1}});let A=[];const x=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],V=async()=>{A=[...await G(),"Show_all"];const t=j(A);r.categoryField.insertAdjacentHTML("beforeend",t),r.abcField.innerHTML=N(x),new Y({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},Z=async e=>{const t=e.target.value,s=o(a.LOCAL_QUERY_KEY);s.page="1",t==="Show_all"?s.category=null:s.category=t,l(a.LOCAL_QUERY_KEY,s);const n=o(a.LOCAL_SORT),c=o(a.LOCAL_QUERY_KEY);let i=h(a.BASE_URL,c);i=_(i,n);const u=await E(i);console.log(u),f(u)},z=async e=>{e.preventDefault();const t=r.searchField.value,s=o(a.LOCAL_QUERY_KEY);s.page="1",t?s.keyword=t:s.keyword=null,l(a.LOCAL_QUERY_KEY,s);const n=o(a.LOCAL_SORT),c=o(a.LOCAL_QUERY_KEY);let i=h(a.BASE_URL,c);i=_(i,n);const u=await E(i);f(u)},h=(e,t)=>{let s=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(s+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(s+=`&category=${W(t.category)}`),s},W=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},_=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},X=async e=>{const t=e.target.value;l(a.LOCAL_SORT,t);const s=o(a.LOCAL_SORT),n=o(a.LOCAL_QUERY_KEY);let c=h(a.BASE_URL,n);c=_(c,s);const i=await E(c);f(i)};async function E(e){try{return(await d({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const f=async e=>{if(!e.results.length){b(r.productList);return}l(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),r.productList.innerHTML=L(e.results),Q()},ee=e=>{if(e.target.value===""){const t=o(a.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,l(a.LOCAL_QUERY_KEY,t);const s=o(a.LOCAL_QUERY_KEY);U(s)}};r.form.addEventListener("submit",z);r.categoryField.addEventListener("change",Z);r.abcField.addEventListener("change",X);r.searchField.addEventListener("input",ee);const te=async()=>{const e=await $();if(!e.length){notFoundMarkup(r.popularProductList);return}const t=y(e),s=F(t);r.popularProductList.insertAdjacentHTML("beforeend",s)},ae=e=>{e.preventDefault(),e.target.closest(".js-cart")&&H(e),e.target.classList.contains("js-info")&&openModal(e)};r.popularProductList.addEventListener("click",ae);const se=e=>{const t=[],s=[];for(;t.length<a.NUMBER_OF_DISCOUNT;){const n=Math.floor(Math.random()*e.length);s.includes(n)||(s.push(n),t.push(e[n]))}return t},re=async()=>{const e=await D(),t=se(e),s=y(t),n=B(s);r.dicsProd.innerHTML=n},ne=e=>{e.preventDefault(),e.target.closest(".js-cart")&&R(e),e.target.classList.contains("js-info")&&openModal(e)};r.discProdList.addEventListener("click",ne);const oe=window.matchMedia("(min-width: 768px)");l(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const ce=o(a.LOCAL_QUERY_KEY)??[];V();U(ce);M(oe);te();re();
//# sourceMappingURL=commonHelpers2.js.map
