import{l as o,c as s,g as L,s as l,f as A,r,h as O,i as y,o as p,m as U,n as k,j as N,k as D,q as j,t as B,u as H,v as $,w as x,x as q,y as J,z as G}from"./assets/modalMarkups-190f613d.js";import{i as w,P as Y,S as v,a as z}from"./assets/vendor-85c19974.js";const d=o(s.LOCAL_CART_KEY)??[],M=async e=>{const{id:t}=e.target.closest(".js-card").dataset,a=await L(t);d.some(({_id:c})=>c===a._id)||(d.push(a),l(s.LOCAL_CART_KEY,d),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${A}#check"></use>
                    </svg>
                </button>`,w.success({title:"OK",message:"Added to cart!"}))},V=async e=>{const{id:t}=e.target.closest(".js-card").dataset,a=await L(t);d.some(({_id:c})=>c===a._id)||(d.push(a),l(s.LOCAL_CART_KEY,d),e.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${A}#check"></use>
                    </svg>
                </button>`,w.success({title:"OK",message:"Added to cart!"}))};let g;const Z=window.matchMedia("(min-width: 768px)"),R=e=>{e.matches?(g=4,b()):(g=2,b())};Z.addEventListener("change",R);function b(){const e=o(s.PAGES).page,t=o(s.PAGES).perPage,a=o(s.PAGES).totalPages;new Y(r.paginationContainer,{page:e,totalItems:t*a,itemsPerPage:t,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(i){const u=JSON.parse(localStorage.getItem("pages"));u.page=i.page,localStorage.setItem("pages",JSON.stringify(u));const I=JSON.parse(localStorage.getItem("pages")),C=o(s.LOCAL_QUERY_KEY);C.page=I.page,l(s.LOCAL_QUERY_KEY,C);const F=o(s.LOCAL_QUERY_KEY);Q(F)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}function T(){new Y(r.paginationContainer,{page:s.INIT_QUERY.page,totalItems:o("pages").perPage*o("pages").totalPages,itemsPerPage:o("pages").perPage,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(a){const n=JSON.parse(localStorage.getItem("pages"));n.page=a.page,localStorage.setItem("pages",JSON.stringify(n));const c=JSON.parse(localStorage.getItem("pages")),i=o(s.LOCAL_QUERY_KEY);i.page=c.page,l(s.LOCAL_QUERY_KEY,i);const u=o(s.LOCAL_QUERY_KEY);Q(u)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}async function Q(e){const t=await O(e);if(!t.results.length){notFoundMarkup(r.productList);return}r.productList.innerHTML=y(t.results)}const _=e=>{const t=o(s.LOCAL_CART_KEY)??[];return e.map(n=>t.some(({_id:i})=>i===n._id)?(n.isChecked=!0,n):(n.isChecked=!1,n))},m=async(e,t)=>{const{id:a}=e.target.closest(".js-card").dataset,n=await L(a),c=U(n);p(t,c)},K=async e=>{r.productList.innerHTML='<div class="loader-box"><span class="loader"></span></div>';const t=await O(e);if(!t.results.length){k(r.productList);return}l(s.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const a=_(t.results);r.productList.innerHTML=y(a),T()},W=e=>{if(e.preventDefault(),e.currentTarget!==e.target){if(e.target.closest(".js-cart")){M(e);return}m(e,r.productList)}};r.productList.addEventListener("click",W);new v({select:"#abcField",settings:{showSearch:!1}});let S=[];const X=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],ee=async()=>{S=[...await N(),"Show_all"];const t=D(S);r.categoryField.insertAdjacentHTML("beforeend",t),r.abcField.innerHTML=j(X),new v({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},te=async e=>{const t=e.target.value,a=o(s.LOCAL_QUERY_KEY);a.page="1",t==="Show_all"?a.category=null:a.category=t,l(s.LOCAL_QUERY_KEY,a);const n=o(s.LOCAL_SORT),c=o(s.LOCAL_QUERY_KEY);let i=h(s.BASE_URL,c);i=E(i,n);const u=await P(i);f(u)},ae=async e=>{e.preventDefault();const t=r.searchField.value,a=o(s.LOCAL_QUERY_KEY);a.page="1",t?a.keyword=t:a.keyword=null,l(s.LOCAL_QUERY_KEY,a);const n=o(s.LOCAL_SORT),c=o(s.LOCAL_QUERY_KEY);let i=h(s.BASE_URL,c);i=E(i,n);const u=await P(i);f(u)},h=(e,t)=>{let a=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(a+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(a+=`&category=${se(t.category)}`),a},se=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},E=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},re=async e=>{const t=e.target.value;l(s.LOCAL_SORT,t);const a=o(s.LOCAL_SORT),n=o(s.LOCAL_QUERY_KEY);let c=h(s.BASE_URL,n);c=E(c,a);const i=await P(c);f(i)};async function P(e){try{return(await z({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const f=async e=>{if(!e.results.length){k(r.productList);return}l(s.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),r.productList.innerHTML=y(e.results),T()},ne=e=>{if(e.target.value===""){const t=o(s.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,l(s.LOCAL_QUERY_KEY,t);const a=o(s.LOCAL_QUERY_KEY);K(a)}};r.form.addEventListener("submit",ae);r.categoryField.addEventListener("change",te);r.abcField.addEventListener("change",re);r.searchField.addEventListener("input",ne);const oe=async()=>{const e=await B();if(!e.length){notFoundMarkup(r.popularProductList);return}const t=_(e),a=H(t);r.popularProductList.insertAdjacentHTML("beforeend",a)},ce=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){V(e);return}m(e,r.popularProductList)};r.popularProductList.addEventListener("click",ce);const ie=e=>{const t=[],a=[];for(;t.length<s.NUMBER_OF_DISCOUNT;){const n=Math.floor(Math.random()*e.length);a.includes(n)||(a.push(n),t.push(e[n]))}return t},le=async()=>{const e=await $(),t=ie(e),a=_(t),n=x(a);r.dicsProd.innerHTML=n},ue=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){M(e);return}m(e,r.discProdList)};r.discProdList.addEventListener("click",ue);const de=()=>{r.emailForm.addEventListener("submit",ge)},ge=e=>{e.preventDefault();const t=r.emailInput.value.trim();t&&pe(t)};async function pe(e){const t=await q(e);switch(t){case 201:p(r.emailForm,G);break;case 409:p(r.emailForm,J);break}return t}const Le=window.matchMedia("(min-width: 768px)");l(s.LOCAL_QUERY_KEY,s.INIT_QUERY);const ye=o(s.LOCAL_QUERY_KEY)??[];ee();K(ye);R(Le);oe();le();de();
//# sourceMappingURL=commonHelpers2.js.map
