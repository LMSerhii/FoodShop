import{c as a,l as o,s as l,b as P,r as n,d as L,n as A,e as U,f as K,g as I,h as j}from"./assets/refs-64b9390c.js";import{a as d,i as S,P as b,S as O}from"./assets/vendor-38dd3e46.js";async function Y(e){try{return(await d({url:`${a.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(t){return t}}async function w(e){try{return(await d({url:`${a.BASE_URL}/products/${e}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){console.log(t)}}async function N(e){try{let t=null;return e&&(t={limit:e}),(await d({url:`${a.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(t){return t}}async function F(){try{return(await d({url:`${a.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function B(){try{return(await d({url:`${a.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}const p=o(a.LOCAL_CART_KEY)??[],k=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await w(t);p.some(({_id:i})=>i===s._id)||(p.push(s),l(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${P}#check"></use>
                    </svg>
                </button>`,S.success({title:"OK",message:"Added to cart!"}))},D=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await w(t);p.some(({_id:i})=>i===s._id)||(p.push(s),l(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="popular-card-btn" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${P}#check"></use>
                    </svg>
                </button>`,S.success({title:"OK",message:"Added to cart!"}))};let g;const R=window.matchMedia("(min-width: 768px)"),T=e=>{e.matches?(g=4,C()):(g=2,C())};T(R);R.addEventListener("change",T);function C(){new b(n.paginationContainer,{page:o("pages").page,totalItems:o("pages").perPage*o("pages").totalPages,itemsPerPage:o("pages").perPage,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const r=JSON.parse(localStorage.getItem("pages"));r.page=s.page,localStorage.setItem("pages",JSON.stringify(r));const i=JSON.parse(localStorage.getItem("pages")),c=o(a.LOCAL_QUERY_KEY);c.page=i.page,l(a.LOCAL_QUERY_KEY,c);const u=o(a.LOCAL_QUERY_KEY);Q(u)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?n.paginationContainer.style.display="none":n.paginationContainer.style.display="block"}function M(){new b(n.paginationContainer,{page:a.INIT_QUERY.page,totalItems:o("pages").perPage*o("pages").totalPages,itemsPerPage:o("pages").perPage,visiblePages:g,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const r=JSON.parse(localStorage.getItem("pages"));r.page=s.page,localStorage.setItem("pages",JSON.stringify(r));const i=JSON.parse(localStorage.getItem("pages")),c=o(a.LOCAL_QUERY_KEY);c.page=i.page,l(a.LOCAL_QUERY_KEY,c);const u=o(a.LOCAL_QUERY_KEY);Q(u)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?n.paginationContainer.style.display="none":n.paginationContainer.style.display="block"}async function Q(e){const t=await Y(e);if(!t.results.length){notFoundMarkup(n.productList);return}n.productList.innerHTML=L(t.results)}const y=e=>{const t=o(a.LOCAL_CART_KEY)??[];return e.map(r=>t.some(({_id:c})=>c===r._id)?(r.isChecked=!0,r):(r.isChecked=!1,r))},v=async e=>{const t=await Y(e);if(!t.results.length){A(n.productList);return}l(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const s=y(t.results);n.productList.innerHTML=L(s),M()},$=e=>{e.preventDefault(),e.target.closest(".js-cart")&&k(e),e.target.classList.contains("js-info")&&openModal(e)};n.productList.addEventListener("click",$);new O({select:"#abcField",settings:{showSearch:!1}});let m=[];const H=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],q=async()=>{m=[...await B(),"Show_all"];const t=U(m);n.categoryField.insertAdjacentHTML("beforeend",t),n.abcField.innerHTML=K(H),new O({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},G=async e=>{const t=e.target.value,s=o(a.LOCAL_QUERY_KEY);s.page="1",t==="Show_all"?s.category=null:s.category=t,l(a.LOCAL_QUERY_KEY,s);const r=o(a.LOCAL_SORT),i=o(a.LOCAL_QUERY_KEY);let c=h(a.BASE_URL,i);c=_(c,r);const u=await f(c);console.log(u),E(u)},J=async e=>{e.preventDefault();const t=n.searchField.value,s=o(a.LOCAL_QUERY_KEY);s.page="1",t?s.keyword=t:s.keyword=null,l(a.LOCAL_QUERY_KEY,s);const r=o(a.LOCAL_SORT),i=o(a.LOCAL_QUERY_KEY);let c=h(a.BASE_URL,i);c=_(c,r);const u=await f(c);E(u)},h=(e,t)=>{let s=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(s+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(s+=`&category=${x(t.category)}`),s},x=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},_=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},V=async e=>{const t=e.target.value;l(a.LOCAL_SORT,t);const s=o(a.LOCAL_SORT),r=o(a.LOCAL_QUERY_KEY);let i=h(a.BASE_URL,r);i=_(i,s);const c=await f(i);E(c)};async function f(e){try{return(await d({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const E=async e=>{if(!e.results.length){A(n.productList);return}l(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),n.productList.innerHTML=L(e.results),M()},Z=e=>{if(e.target.value===""){const t=o(a.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,l(a.LOCAL_QUERY_KEY,t);const s=o(a.LOCAL_QUERY_KEY);v(s)}};n.form.addEventListener("submit",J);n.categoryField.addEventListener("change",G);n.abcField.addEventListener("change",V);n.searchField.addEventListener("input",Z);const z=async()=>{const e=await N();if(!e.length){notFoundMarkup(n.popularProductList);return}const t=y(e),s=I(t);n.popularProductList.insertAdjacentHTML("beforeend",s)},W=e=>{e.preventDefault(),e.target.closest(".js-cart")&&D(e),e.target.classList.contains("js-info")&&openModal(e)};n.popularProductList.addEventListener("click",W);const X=e=>{const t=[],s=[];for(;t.length<a.NUMBER_OF_DISCOUNT;){const r=Math.floor(Math.random()*e.length);s.includes(r)||(s.push(r),t.push(e[r]))}return t},ee=async()=>{const e=await F(),t=X(e),s=y(t),r=j(s);n.dicsProd.innerHTML=r},te=e=>{e.preventDefault(),e.target.closest(".js-cart")&&k(e),e.target.classList.contains("js-info")&&openModal(e)};n.discProdList.addEventListener("click",te);l(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const ae=o(a.LOCAL_QUERY_KEY)??[];q();v(ae);z();ee();
//# sourceMappingURL=commonHelpers2.js.map
