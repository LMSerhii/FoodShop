import{c as a,l as o,s as n,b as g,r as s,n as L,d as y,e as h,f as C,g as P,h as Y}from"./assets/refs-db7eb833.js";import{a as u,S as E}from"./assets/vendor-09298f01.js";async function k(e){try{return(await u({url:`${a.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(t){return t}}async function _(e){try{return(await u({url:`${a.BASE_URL}/products/${e}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}async function T(e){try{let t=null;return e&&(t={limit:e}),(await u({url:`${a.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(t){return t}}async function S(){try{return(await u({url:`${a.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function b(){try{return(await u({url:`${a.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}const l=o(a.LOCAL_CART_KEY)??[],w=async e=>{const{id:t}=e.target.closest(".js-card").dataset,r=await _(t);l.some(({_id:i})=>i===r._id)||(l.push(r),n(a.LOCAL_CART_KEY,l),e.target.closest(".js-cart").innerHTML=`<button class="btn-check js-cart" type="button">
   <svg class="icon-check" width="18" height="18">
                               <use href="${g}#check"></use>
                           </svg>
                         </button>`)},m=async e=>{const{id:t}=e.target.closest(".js-card").dataset,r=await _(t);l.some(({_id:i})=>i===r._id)||(l.push(r),n(a.LOCAL_CART_KEY,l),e.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check js-cart" type="button">
   <svg class="popular-icon-check" width="18" height="18">
                               <use href="${g}#check"></use>
                           </svg>
                         </button>`)},p=async e=>{const t=await k(e);if(!t.results.length){L(s.productList);return}n(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages}),s.productList.innerHTML=y(t.results)},R=e=>{e.preventDefault(),e.target.closest(".js-cart")&&w(e),e.target.classList.contains("js-info")&&openModal(e)};s.productList.addEventListener("click",R);new E({select:"#abcField",settings:{placeholderText:"A to Z",showSearch:!1}});const v=async()=>{const e=await b(),t=h(e);s.categoryField.insertAdjacentHTML("beforeend",t),new E({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})};v();let d=[];const U=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],j=async()=>{d=[...await b(),"Show_all"];const t=h(d);s.categoryField.insertAdjacentHTML("beforeend",t),s.abcField.innerHTML=C(U)},Q=e=>{const t=e.target.value,r=o(a.LOCAL_QUERY_KEY);t==="Show_all"?r.category=null:r.category=t,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY);p(c)},M=e=>{e.preventDefault();const t=s.searchField.value,r=o(a.LOCAL_QUERY_KEY);t?r.keyword=t:r.keyword=null,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY);p(c)},O=async e=>{const t=e.target.value,r=o(a.LOCAL_QUERY_KEY);r.sort=t,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY),i=c.sort,A=K(i),f=await F(c,A);$(f)},K=e=>{let t={};switch(e){case"alphabetical":t="&byABC=true";break;case"reverse-alphabetical":t="&byABC=false";break;case"cheap":t="&byPrice=true";break;case"expensive":t="&byPrice=false";break;case"popular":t="&byPopularity=false";break;case"not-popular":t="&byPopularity=true";break}return t};async function F(e,t){try{return(await u({url:`${a.BASE_URL}/products?${t}`,method:"GET",header:{"Content-Type":"application/json"},params:e})).data}catch(r){return r}}const $=async e=>{if(!e.results.length){L(s.productList);return}n(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),s.productList.innerHTML=y(e.results)},D=e=>{if(e.target.value===""){const t=o(a.LOCAL_QUERY_KEY);t.keyword=null,n(a.LOCAL_QUERY_KEY,t);const r=o(a.LOCAL_QUERY_KEY);p(r)}};s.form.addEventListener("submit",M);s.categoryField.addEventListener("change",Q);s.abcField.addEventListener("change",O);s.searchField.addEventListener("input",D);const G=async()=>{const e=await T();if(!e.length){notFoundMarkup(s.popularProductList);return}n(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages});const t=P(e);s.popularProductList.insertAdjacentHTML("beforeend",t)},H=e=>{e.preventDefault(),e.target.closest(".js-cart")&&m(e),e.target.classList.contains("js-info")&&openModal(e)};s.popularProductList.addEventListener("click",H);const B=async()=>{const e=await S(),t=Y(e.slice(0,2));s.dicsProd.innerHTML=t},q=()=>{};s.discProdList.addEventListener("click",q());n(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const x=o(a.LOCAL_QUERY_KEY)??[];j();p(x);G();B();
//# sourceMappingURL=commonHelpers2.js.map
