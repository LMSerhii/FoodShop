import{l as r,c as a,g as A,s as c,f as M,r as n,h as U,i as Y,d as G,m as V,n as x,j as z,k as Z,q as W,t as X,u as ee,v as te,w as ae,x as se,o as K,y as re,z as ne}from"./assets/modalMarkups-b5407a0d.js";import{i as j,P as q,b as oe,S as I,a as ce}from"./assets/vendor-85c19974.js";const m=()=>{const e=document.querySelector("#product-count-header"),t=r(a.LOCAL_CART_KEY)??[];e.innerHTML=`(${t.length})`},_=r(a.LOCAL_CART_KEY)??[],F=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await A(t);_.some(({_id:l})=>l===s._id)||(_.push(s),c(a.LOCAL_CART_KEY,_),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${M}#check"></use>
                    </svg>
                </button>`,m(),j.success({title:"OK",message:"Added to cart!"}))},ie=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await A(t);_.some(({_id:l})=>l===s._id)||(_.push(s),c(a.LOCAL_CART_KEY,_),e.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${M}#check"></use>
                    </svg>
                </button>`,m(),j.success({title:"OK",message:"Added to cart!"}))};let y;const le=window.matchMedia("(min-width: 768px)"),N=e=>{e.matches?(y=4,v()):(y=2,v())};le.addEventListener("change",N);function v(){const e=r(a.PAGES).page,t=r(a.PAGES).perPage,s=r(a.PAGES).totalPages;new q(n.paginationContainer,{page:e,totalItems:t*s,itemsPerPage:t,visiblePages:y,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(i){const d=JSON.parse(localStorage.getItem("pages"));d.page=i.page,localStorage.setItem("pages",JSON.stringify(d));const u=JSON.parse(localStorage.getItem("pages")),E=r(a.LOCAL_QUERY_KEY);E.page=u.page,c(a.LOCAL_QUERY_KEY,E);const R=r(a.LOCAL_QUERY_KEY);B(R)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?n.paginationContainer.style.display="none":n.paginationContainer.style.display="block"}function D(){new q(n.paginationContainer,{page:a.INIT_QUERY.page,totalItems:r("pages").perPage*r("pages").totalPages,itemsPerPage:r("pages").perPage,visiblePages:y,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const o=JSON.parse(localStorage.getItem("pages"));o.page=s.page,localStorage.setItem("pages",JSON.stringify(o));const l=JSON.parse(localStorage.getItem("pages")),i=r(a.LOCAL_QUERY_KEY);i.page=l.page,c(a.LOCAL_QUERY_KEY,i);const d=r(a.LOCAL_QUERY_KEY);B(d)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?n.paginationContainer.style.display="none":n.paginationContainer.style.display="block"}async function B(e){const t=await U(e);if(!t.results.length){notFoundMarkup(n.productList);return}n.productList.innerHTML=Y(t.results)}const O=e=>{const t=r(a.LOCAL_CART_KEY)??[];return e.map(o=>t.some(({_id:i})=>i===o._id)?(o.isChecked=!0,o):(o.isChecked=!1,o))},P=async(e,t)=>{const{id:s}=e.target.closest(".js-card").dataset,o=await A(s),l=V(o),i=oe.create(l,{onShow:u=>{t.addEventListener("keydown",d),u.element().querySelector(".js-modal-close").onclick=()=>{u.close();const g=r(a.LOCAL_QUERY_KEY)??[];p(g)},(r(a.LOCAL_CART_KEY)??[]).some(({_id:g})=>g===s)?(u.element().querySelector(".js-to-cart").style.display="none",u.element().querySelector(".js-from-cart").style.display="flex"):(u.element().querySelector(".js-to-cart").style.display="flex",u.element().querySelector(".js-from-cart").style.display="none");const h=u.element().querySelector(".js-to-cart"),C=u.element().querySelector(".js-from-cart");h.addEventListener("click",()=>{const g=r(a.LOCAL_CART_KEY)??[];g.some(({_id:f})=>f===s)||(g.push(o),c(a.LOCAL_CART_KEY,g),m(),h.style.display="none",C.style.display="flex")}),C.addEventListener("click",()=>{const g=r(a.LOCAL_CART_KEY)??[],Q=g.findIndex(({_id:f})=>f===s);g.splice(Q,1),G(a.LOCAL_CART_KEY),c(a.LOCAL_CART_KEY,g),m(),C.style.display="none",h.style.display="flex"})},onClose:u=>{t.removeEventListener("keydown",d)}});function d(u){u.code==="Escape"&&i.close()}i.show()},p=async e=>{n.productList.innerHTML='<div class="loader-box"><span class="loader"></span></div>';const t=await U(e);if(!t.results.length){x(n.productList);return}c(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const s=O(t.results);n.productList.innerHTML=Y(s),D()},ue=e=>{if(e.preventDefault(),e.currentTarget!==e.target){if(e.target.closest(".js-cart")){F(e);return}P(e,n.productList)}};n.productList.addEventListener("click",ue);new I({select:"#abcField",settings:{showSearch:!1}});let T=[];const de=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],ge=async()=>{T=[...await z(),"Show_all"];const t=Z(T);n.categoryField.insertAdjacentHTML("beforeend",t),n.abcField.innerHTML=W(de),new I({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},pe=async e=>{const t=e.target.value,s=r(a.LOCAL_QUERY_KEY);s.page="1",t==="Show_all"?s.category=null:s.category=t,c(a.LOCAL_QUERY_KEY,s);const o=r(a.LOCAL_SORT),l=r(a.LOCAL_QUERY_KEY);let i=S(a.BASE_URL,l);i=b(i,o);const d=await w(i);k(d)},Le=async e=>{e.preventDefault();const t=n.searchField.value,s=r(a.LOCAL_QUERY_KEY);s.page="1",t?s.keyword=t:s.keyword=null,c(a.LOCAL_QUERY_KEY,s);const o=r(a.LOCAL_SORT),l=r(a.LOCAL_QUERY_KEY);let i=S(a.BASE_URL,l);i=b(i,o);const d=await w(i);k(d)},S=(e,t)=>{let s=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(s+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(s+=`&category=${_e(t.category)}`),s},_e=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},b=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},me=async e=>{const t=e.target.value;c(a.LOCAL_SORT,t);const s=r(a.LOCAL_SORT),o=r(a.LOCAL_QUERY_KEY);let l=S(a.BASE_URL,o);l=b(l,s);const i=await w(l);k(i)};async function w(e){try{return(await ce({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const k=async e=>{if(!e.results.length){x(n.productList);return}c(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),n.productList.innerHTML=Y(e.results),D()},ye=e=>{if(e.target.value===""){const t=r(a.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,c(a.LOCAL_QUERY_KEY,t);const s=r(a.LOCAL_QUERY_KEY);p(s)}};n.form.addEventListener("submit",Le);n.categoryField.addEventListener("change",pe);n.abcField.addEventListener("change",me);n.searchField.addEventListener("input",ye);const Ee=async()=>{const e=await X();if(!e.length){notFoundMarkup(n.popularProductList);return}const t=O(e),s=ee(t);n.popularProductList.insertAdjacentHTML("beforeend",s)},he=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){ie(e);return}P(e,n.popularProductList)};n.popularProductList.addEventListener("click",he);const Ce=e=>{const t=[],s=[];for(;t.length<a.NUMBER_OF_DISCOUNT;){const o=Math.floor(Math.random()*e.length);s.includes(o)||(s.push(o),t.push(e[o]))}return t},fe=async()=>{const e=await te(),t=Ce(e),s=O(t),o=ae(s);n.dicsProd.innerHTML=o},Ae=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){F(e);return}P(e,n.discProdList)};n.discProdList.addEventListener("click",Ae);const Ye=()=>{n.emailForm.addEventListener("submit",Oe)},Oe=e=>{e.preventDefault();const t=n.emailInput.value.trim();t&&(Pe(t),n.emailForm.reset())};async function Pe(e){const t=await se(e);switch(t){case 201:K(n.emailForm,ne);break;case 409:K(n.emailForm,re);break}return t}const H=window.matchMedia("(min-width: 768px)"),$=window.matchMedia("(min-width: 1440px)"),J=window.matchMedia("(max-width: 767.9px)"),Se=window.matchMedia("(max-width: 1439.9px)"),be=window.matchMedia("(min-width: 768px) and (max-width: 1439.9px)");c(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const L=r(a.LOCAL_QUERY_KEY)??[];m();ge();if($.matches&&Object.keys(L).length){const e=r(a.LOCAL_QUERY_KEY)??[];e.limit=9,c(a.LOCAL_QUERY_KEY,e),p(e)}if(be.matches&&Object.keys(L).length){const e=r(a.LOCAL_QUERY_KEY)??[];e.limit=8,c(a.LOCAL_QUERY_KEY,e),p(e)}if(J.matches&&Object.keys(L).length){const e=r(a.LOCAL_QUERY_KEY)??[];e.limit=6,c(a.LOCAL_QUERY_KEY,e),p(e)}N(H);Ee();fe();Ye();H.addListener(e=>{if(e.matches&&Object.keys(L).length){const t=r(a.LOCAL_QUERY_KEY)??[];t.limit=8,c(a.LOCAL_QUERY_KEY,t),p(t)}});$.addListener(e=>{if(e.matches&&Object.keys(L).length){const t=r(a.LOCAL_QUERY_KEY)??[];t.limit=9,c(a.LOCAL_QUERY_KEY,t),p(t)}});Se.addListener(e=>{if(e.matches&&Object.keys(L).length){const t=r(a.LOCAL_QUERY_KEY)??[];t.limit=8,c(a.LOCAL_QUERY_KEY,t),p(t)}});J.addListener(e=>{if(e.matches&&Object.keys(L).length){const t=r(a.LOCAL_QUERY_KEY)??[];t.limit=6,c(a.LOCAL_QUERY_KEY,t),p(t)}});
//# sourceMappingURL=commonHelpers2.js.map
