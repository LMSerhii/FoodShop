import{c as a,l as o,s as n,b as L,r as s,n as g,d as y,e as b,f as A,g as C,h as f}from"./assets/refs-db7eb833.js";import{a as l}from"./assets/vendor-b325e1ef.js";async function P(t){try{return(await l({url:`${a.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(e){return e}}async function E(t){try{return(await l({url:`${a.BASE_URL}/products/${t}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function Y(t){try{let e=null;return t&&(e={limit:t}),(await l({url:`${a.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(e){return e}}async function k(){try{return(await l({url:`${a.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}async function T(){try{return(await l({url:`${a.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}const u=o(a.LOCAL_CART_KEY)??[],R=async t=>{const{id:e}=t.target.closest(".js-card").dataset,r=await E(e);u.some(({_id:i})=>i===r._id)||(u.push(r),n(a.LOCAL_CART_KEY,u),t.target.closest(".js-cart").innerHTML=`<button class="btn-check js-cart" type="button">
   <svg class="icon-check" width="18" height="18">
                               <use href="${L}#check"></use>
                           </svg>
                         </button>`)},m=async t=>{const{id:e}=t.target.closest(".js-card").dataset,r=await E(e);u.some(({_id:i})=>i===r._id)||(u.push(r),n(a.LOCAL_CART_KEY,u),t.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check js-cart" type="button">
   <svg class="popular-icon-check" width="18" height="18">
                               <use href="${L}#check"></use>
                           </svg>
                         </button>`)},p=async t=>{const e=await P(t);if(!e.results.length){g(s.productList);return}n(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),s.productList.innerHTML=y(e.results)},S=t=>{t.preventDefault(),t.target.closest(".js-cart")&&R(t),t.target.classList.contains("js-info")&&openModal(t)};s.productList.addEventListener("click",S);let d=[];const v=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],w=async()=>{d=[...await T(),"Show_all"];const e=b(d);s.categoryField.insertAdjacentHTML("beforeend",e),s.abcField.innerHTML=A(v)},U=t=>{const e=t.target.value,r=o(a.LOCAL_QUERY_KEY);e==="Show_all"?r.category=null:r.category=e,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY);p(c)},Q=t=>{t.preventDefault();const e=s.searchField.value,r=o(a.LOCAL_QUERY_KEY);e?r.keyword=e:r.keyword=null,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY);p(c)},j=async t=>{const e=t.target.value,r=o(a.LOCAL_QUERY_KEY);r.sort=e,n(a.LOCAL_QUERY_KEY,r);const c=o(a.LOCAL_QUERY_KEY),i=c.sort,h=O(i),_=await K(c,h);M(_)},O=t=>{let e={};switch(t){case"alphabetical":e="&byABC=true";break;case"reverse-alphabetical":e="&byABC=false";break;case"cheap":e="&byPrice=true";break;case"expensive":e="&byPrice=false";break;case"popular":e="&byPopularity=false";break;case"not-popular":e="&byPopularity=true";break}return e};async function K(t,e){try{return(await l({url:`${a.BASE_URL}/products?${e}`,method:"GET",header:{"Content-Type":"application/json"},params:t})).data}catch(r){return r}}const M=async t=>{if(!t.results.length){g(s.productList);return}n(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages}),s.productList.innerHTML=y(t.results)},F=t=>{if(t.target.value===""){const e=o(a.LOCAL_QUERY_KEY);e.keyword=null,n(a.LOCAL_QUERY_KEY,e);const r=o(a.LOCAL_QUERY_KEY);p(r)}};s.form.addEventListener("submit",Q);s.categoryField.addEventListener("change",U);s.abcField.addEventListener("change",j);s.searchField.addEventListener("input",F);const $=async()=>{const t=await Y();if(!t.length){notFoundMarkup(s.popularProductList);return}n(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const e=C(t);s.popularProductList.insertAdjacentHTML("beforeend",e)},D=t=>{t.preventDefault(),t.target.closest(".js-cart")&&m(t),t.target.classList.contains("js-info")&&openModal(t)};s.popularProductList.addEventListener("click",D);const G=async()=>{const t=await k(),e=f(t.slice(0,2));s.dicsProd.innerHTML=e},B=()=>{};s.discProdList.addEventListener("click",B());n(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const H=o(a.LOCAL_QUERY_KEY)??[];w();p(H);$();G();
//# sourceMappingURL=commonHelpers2.js.map
