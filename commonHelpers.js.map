{"version":3,"file":"commonHelpers.js","sources":["../src/img/yellow_shopping_basket.png","../src/js/cart_2.js"],"sourcesContent":["export default \"__VITE_ASSET__d35d7aca__\"","import { load, save, remove } from './storage';\nimport { common } from './common';\nimport emty_cart from '../img/yellow_shopping_basket.png';\nimport { createOrder } from './api_service';\nimport svg_sprite from '../img/sprite.svg';\n\nconst refs = {\n  cartList: document.querySelector('.cart-list'),\n  deleteAll: document.querySelector('.cart-delete-all'),\n  orderBox: document.querySelector('.order-box'),\n  orderForm: document.querySelector('.order-form'),\n  totalSum: document.querySelector('.order-box-total-price-var'),\n};\n\nconst createCartListMarkup = arrey => {\n  if (!arrey.length) {\n    return `<li class=\"emty-cart\">\n                    <img src=\"${emty_cart}\" alt=\"Emty Cart\" class=\"emty-cart-img\" width=\"132\" height=\"114\" />\n                    <p class=\"emty-cart-title\">\n                        Your basket is <span class=\"accent\">empty...</span>\n                    </p>\n                    <p class=\"emty-cart-text\">\n                        Go to the main page to select your favorite products and add them to the\n                        cart.\n                    </p>\n            </li>`;\n  }\n\n  return arrey.map(({ _id, img, name, category, size, price }) => {\n    return `<li class=\"cart-item js-card\" data-id=\"${_id}\">\n                    <button class=\"cart-product-delete js-product-cart-delete\">\n                        <svg class=\"cart-product-delete-icon\" width=\"18\" height=\"18\">\n                            <use href=\"${svg_sprite}#close\"></use>\n                        </svg>\n                    </button>\n\n                <img src=\"${img}\" alt=\"${name}\" class=\"cart-img\" />\n                <div class=\"cart-content\">\n                    <p class=\"cart-content-title\">${name}</p>\n                    <ul class=\"cart-content-list\">\n                        <li class=\"cart-content-item\">\n                        Category:\n                        <span class=\"cart-content-item-var\">${category}</span>\n                        </li>\n                        <li class=\"cart-content-item\">\n                        Size:\n                        <span class=\"cart-content-item-var\">${size}</span>\n                        </li>\n                    </ul>\n                    <div class=\"cart-content-bottom\">   \n                        <p class=\"cart-content-price\">$${price}</p>\n                      \n\n                        <div class=\"cart-content-bottom-addition\">\n                        <button class=\"cart-content-bottom\" type=\"button\" aria-label=\"subtraction\">\n                          <svg class=\"minus-icon\" width=\"18\" height=\"18\" aria-label=\"minus\">\n                            <use class=\"cart-minus-svg\" href=\"${svg_sprite}#minus\"></use>\n                          </svg>\n                        </button>\n\n                        <span class=\"quantity\">1</span>\n\n                        <button class=\"cart-content-bottom\" type=\"button\" aria-label=\"addition\">\n                          <svg class=\"plus-icon\" width=\"18\" height=\"18\" aria-label=\"plus\">\n                            <use class=\"cart-plus-svg\" href=\"${svg_sprite}#plus\"></use>\n                          </svg>\n                        </button>\n                      </div>\n\n                        \n                    </div>\n                </div>\n            </li>\n        `;\n  });\n};\n\nconst totalAmount = () => {\n  const currCart = load(common.LOCAL_CART_KEY) ?? [];\n\n  if (!currCart.length) {\n    return;\n  }\n\n  const count = 1;\n\n  return currCart\n    .reduce((acc, product) => acc + product.price * count, 0)\n    .toFixed(2);\n};\n\nconst renderCartList = () => {\n  const currentCartList = load(common.LOCAL_CART_KEY) ?? [];\n\n  if (!currentCartList.length) {\n    refs.deleteAll.style.display = 'none';\n    refs.orderBox.style.display = 'none';\n    const markup = createCartListMarkup(currentCartList);\n    refs.cartList.innerHTML = markup;\n    return;\n  }\n\n  refs.deleteAll.style.display = 'flex';\n  refs.orderBox.style.display = 'block';\n\n  const markup = createCartListMarkup(currentCartList);\n  const total = totalAmount();\n  refs.cartList.innerHTML = markup;\n  refs.totalSum.innerHTML = `$${total}`;\n};\n\nconst cartCount = () => {\n  const cartCounter = document.querySelector('#product-count-cart');\n  const currValue = load(common.LOCAL_CART_KEY) ?? [];\n  cartCounter.innerHTML = `(${currValue.length})`;\n};\n\nconst onDeleteAll = () => {\n  save(common.LOCAL_CART_KEY, []);\n  renderCartList();\n};\n\nconst onCartListClick = evt => {\n  if (evt.currentTarget === evt.target) {\n    return;\n  }\n\n  if (evt.target.closest('.js-product-cart-delete')) {\n    const { id } = evt.target.closest('.js-card').dataset;\n\n    const currentCart = load(common.LOCAL_CART_KEY) ?? [];\n\n    const index = currentCart.findIndex(({ _id }) => _id === id);\n\n    currentCart.splice(index, 1);\n\n    remove(common.LOCAL_CART_KEY);\n\n    save(common.LOCAL_CART_KEY, currentCart);\n\n    // headerCount();\n\n    cartCount();\n    renderCartList();\n  }\n};\n\nconst onOrderForm = evt => {\n  evt.preventDefault();\n  const email = document.querySelector('.order-box-input').value;\n\n  if (!email) {\n    alert('blank space');\n    return;\n  }\n\n  const testEmail = 'goodemail@gmail.com';\n\n  const currCart = load(common.LOCAL_CART_KEY) ?? [];\n\n  let orderList = [];\n\n  currCart.map(element => {\n    orderList.push({\n      productId: element._id,\n      amount: 1,\n    });\n  });\n\n  const data = JSON.stringify({\n    email: testEmail,\n    products: orderList,\n  });\n\n  createOrder(data);\n};\n\nrefs.orderForm.addEventListener('submit', onOrderForm);\n\nrefs.cartList.addEventListener('click', onCartListClick);\n\nrefs.deleteAll.addEventListener('click', onDeleteAll);\n\ncartCount();\nrenderCartList();\n"],"names":["empty_basket","refs","createCartListMarkup","arrey","_id","img","name","category","size","price","svg_sprite","emty_cart","totalAmount","currCart","load","common","count","acc","product","renderCartList","currentCartList","markup","total","cartCount","cartCounter","currValue","onDeleteAll","save","onCartListClick","evt","id","currentCart","index","remove","onOrderForm","testEmail","orderList","element","data","createOrder"],"mappings":"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"}