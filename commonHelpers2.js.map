{"version":3,"file":"commonHelpers2.js","sources":["../src/js/cart.js"],"sourcesContent":["import { load, save, remove } from './storage';\nimport { common } from './common';\nimport { producCartMarkup } from './markupFunctions';\n\nimport { refs } from './refs';\nimport empty_basket from '../img/yellow_shopping_basket.png';\n\nconst cart = load(common.LOCAL_CART_KEY) ?? [];\n\nconst orderContainer = document.querySelector('.order-container');\n\nconst renderItemCount = () => {\n  const itemCount = cart.length;\n\n  refs.productsCount.textContent = `(${itemCount})`;\n  refs.productsCountHeader.textContent = `(${itemCount})`;\n};\n\nconst validClose = productId => {\n  const index = cart.findIndex(({ _id }) => _id === productId);\n\n  cart.splice(index, 1);\n  remove(common.LOCAL_CART_KEY);\n  save(common.LOCAL_CART_KEY, cart);\n  console.log(cart);\n  refs.cartList.innerHTML = producCartMarkup(cart);\n  renderTotalAmount(); // Оновлення суми при видаленні товару\n  renderItemCount();\n};\n\n\nconst onClose = evt => {\n  const closeButton = evt.target.closest('.js-close');\n  // console.log(evt.target);\n  if (!closeButton) {\n    return;\n  }\n\n  const id = evt.target.closest('.js-card').dataset.id;\n  // console.log(evt.target);\n  // console.log(cart);\n  clearCartLocalStorage()\n  if (evt.target.classList.contains('js-close')) {\n    validClose(id); \n    // orderContainer.innerHTML = '';\n    // refs.deleteAllButton.innerHTML = '';\n  }\n};\n\n\n\n\nconst renderTotalAmount = () => {\n  const totalAmount = cart\n    .reduce((acc, product) => acc + product.price, 0)\n    .toFixed(2);\n  refs.totalAmountDisplay.textContent = `$${totalAmount}`;\n};\n\n// Функція для очищення значення ключа \"cart\" у локальному сховищі\nconst clearCartLocalStorage = () => {\n  \n  localStorage.setItem('cart', '[]');\n  notFound()\n  \n  // location.reload();\n};\n\nconst notFound = () => {\n  \n  refs.cartList.innerHTML = `<li><img class=\"basket-img\" src=\"${empty_basket}\" alt=\"Yellow empty basket\">\n  <div class=\"basket-text\">\n      <p class=\"empty-text\"> Your basket is <span>empty...</span></p>\n      <p class=\"empty-comment\">Go to the main page to select your favorite products and add them to the cart.</p>\n  </div></li>`;\n  // orderContainer.innerHTML = '';\n  refs.deleteAllButton.innerHTML = '';\n  \n};\n\nconst renderCart = () => {\n  if (cart.length > 3) {\n    // Застосування вертикального скролу\n    refs.cartList.classList.add('scrollable');\n  }\n\n  if (!cart.length) {\n    notFound();\n    return;\n  }\n\n  refs.cartList.innerHTML = producCartMarkup(cart);\n  \n\n  renderTotalAmount();\n};\nrenderItemCount();\nrenderCart();\nrefs.cartList.addEventListener('click', onClose);\n\n// Додавання обробника подій для кнопки \"Delete all\"\nrefs.deleteAllButton.addEventListener('click', clearCartLocalStorage, renderTotalAmount, notFound, renderItemCount);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nexport { clearCartLocalStorage, renderCart, onClose };\n"],"names":["cart","load","common","renderItemCount","itemCount","refs","validClose","productId","index","_id","remove","save","producCartMarkup","renderTotalAmount","onClose","evt","id","clearCartLocalStorage","totalAmount","acc","product","notFound","empty_basket","renderCart"],"mappings":"4JAOA,MAAMA,EAAOC,EAAKC,EAAO,cAAc,GAAK,CAAA,EAErB,SAAS,cAAc,kBAAkB,EAEhE,MAAMC,EAAkB,IAAM,CAC5B,MAAMC,EAAYJ,EAAK,OAEvBK,EAAK,cAAc,YAAc,IAAID,KACrCC,EAAK,oBAAoB,YAAc,IAAID,IAC7C,EAEME,EAAaC,GAAa,CAC9B,MAAMC,EAAQR,EAAK,UAAU,CAAC,CAAE,IAAAS,KAAUA,IAAQF,CAAS,EAE3DP,EAAK,OAAOQ,EAAO,CAAC,EACpBE,EAAOR,EAAO,cAAc,EAC5BS,EAAKT,EAAO,eAAgBF,CAAI,EAChC,QAAQ,IAAIA,CAAI,EAChBK,EAAK,SAAS,UAAYO,EAAiBZ,CAAI,EAC/Ca,IACAV,GACF,EAGMW,EAAUC,GAAO,CAGrB,GAAI,CAFgBA,EAAI,OAAO,QAAQ,WAAW,EAGhD,OAGF,MAAMC,EAAKD,EAAI,OAAO,QAAQ,UAAU,EAAE,QAAQ,GAGlDE,EAAuB,EACnBF,EAAI,OAAO,UAAU,SAAS,UAAU,GAC1CT,EAAWU,CAAE,CAIjB,EAKMH,EAAoB,IAAM,CAC9B,MAAMK,EAAclB,EACjB,OAAO,CAACmB,EAAKC,IAAYD,EAAMC,EAAQ,MAAO,CAAC,EAC/C,QAAQ,CAAC,EACZf,EAAK,mBAAmB,YAAc,IAAIa,GAC5C,EAGMD,EAAwB,IAAM,CAElC,aAAa,QAAQ,OAAQ,IAAI,EACjCI,EAAU,CAGZ,EAEMA,EAAW,IAAM,CAErBhB,EAAK,SAAS,UAAY,oCAAoCiB;AAAA;AAAA;AAAA;AAAA,eAM9DjB,EAAK,gBAAgB,UAAY,EAEnC,EAEMkB,EAAa,IAAM,CAMvB,GALIvB,EAAK,OAAS,GAEhBK,EAAK,SAAS,UAAU,IAAI,YAAY,EAGtC,CAACL,EAAK,OAAQ,CAChBqB,IACA,MACD,CAEDhB,EAAK,SAAS,UAAYO,EAAiBZ,CAAI,EAG/Ca,GACF,EACAV,IACAoB,IACAlB,EAAK,SAAS,iBAAiB,QAASS,CAAO,EAG/CT,EAAK,gBAAgB,iBAAiB,QAASY,EAAuBJ,EAAmBQ,EAAUlB,CAAe"}