import{l as c,c as a,g as h,s as l,f as S,r,h as Q,i as _,m as B,n as R,j as H,k as q,q as $,t as J,u as G,v as V,w as z,x as Z,o as A,y as W,z as X}from"./assets/modalMarkups-a149f7cd.js";import{i as v,P as M,b as ee,S as K,a as te}from"./assets/vendor-85c19974.js";const y=()=>{const e=document.querySelector("#product-count-header"),t=c(a.LOCAL_CART_KEY)??[];e.innerHTML=`(${t.length})`},L=c(a.LOCAL_CART_KEY)??[],T=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await h(t);L.some(({_id:d})=>d===s._id)||(L.push(s),l(a.LOCAL_CART_KEY,L),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${S}#check"></use>
                    </svg>
                </button>`,y(),v.success({title:"OK",message:"Added to cart!"}))},ae=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await h(t);L.some(({_id:d})=>d===s._id)||(L.push(s),l(a.LOCAL_CART_KEY,L),e.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${S}#check"></use>
                    </svg>
                </button>`,y(),v.success({title:"OK",message:"Added to cart!"}))};let m;const se=window.matchMedia("(min-width: 768px)"),U=e=>{e.matches?(m=4,Y()):(m=2,Y())};se.addEventListener("change",U);function Y(){const e=c(a.PAGES).page,t=c(a.PAGES).perPage,s=c(a.PAGES).totalPages;new M(r.paginationContainer,{page:e,totalItems:t*s,itemsPerPage:t,visiblePages:m,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(i){const u=JSON.parse(localStorage.getItem("pages"));u.page=i.page,localStorage.setItem("pages",JSON.stringify(u));const p=JSON.parse(localStorage.getItem("pages")),w=c(a.LOCAL_QUERY_KEY);w.page=p.page,l(a.LOCAL_QUERY_KEY,w);const D=c(a.LOCAL_QUERY_KEY);I(D)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}function F(){new M(r.paginationContainer,{page:a.INIT_QUERY.page,totalItems:c("pages").perPage*c("pages").totalPages,itemsPerPage:c("pages").perPage,visiblePages:m,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const o=JSON.parse(localStorage.getItem("pages"));o.page=s.page,localStorage.setItem("pages",JSON.stringify(o));const d=JSON.parse(localStorage.getItem("pages")),i=c(a.LOCAL_QUERY_KEY);i.page=d.page,l(a.LOCAL_QUERY_KEY,i);const u=c(a.LOCAL_QUERY_KEY);I(u)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}async function I(e){const t=await Q(e);if(!t.results.length){notFoundMarkup(r.productList);return}r.productList.innerHTML=_(t.results)}const E=e=>{const t=c(a.LOCAL_CART_KEY)??[];return e.map(o=>t.some(({_id:i})=>i===o._id)?(o.isChecked=!0,o):(o.isChecked=!1,o))},f=async(e,t)=>{const{id:s}=e.target.closest(".js-card").dataset,o=await h(s),d=B(o),i=p=>{p.code==="Escape"&&u.close()},u=ee.create(d,{onShow:p=>{t.addEventListener("keydown",i),p.element().querySelector(".js-modal-close").onclick=()=>p.close()},onClose:p=>{t.removeEventListener("keydown",i)}});u.show()},g=async e=>{r.productList.innerHTML='<div class="loader-box"><span class="loader"></span></div>';const t=await Q(e);if(!t.results.length){R(r.productList);return}l(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const s=E(t.results);r.productList.innerHTML=_(s),F()},re=e=>{if(e.preventDefault(),e.currentTarget!==e.target){if(e.target.closest(".js-cart")){T(e);return}f(e,r.productList)}};r.productList.addEventListener("click",re);new K({select:"#abcField",settings:{showSearch:!1}});let k=[];const ne=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],oe=async()=>{k=[...await H(),"Show_all"];const t=q(k);r.categoryField.insertAdjacentHTML("beforeend",t),r.abcField.innerHTML=$(ne),new K({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},ce=async e=>{const t=e.target.value,s=c(a.LOCAL_QUERY_KEY);s.page="1",t==="Show_all"?s.category=null:s.category=t,l(a.LOCAL_QUERY_KEY,s);const o=c(a.LOCAL_SORT),d=c(a.LOCAL_QUERY_KEY);let i=C(a.BASE_URL,d);i=P(i,o);const u=await b(i);O(u)},ie=async e=>{e.preventDefault();const t=r.searchField.value,s=c(a.LOCAL_QUERY_KEY);s.page="1",t?s.keyword=t:s.keyword=null,l(a.LOCAL_QUERY_KEY,s);const o=c(a.LOCAL_SORT),d=c(a.LOCAL_QUERY_KEY);let i=C(a.BASE_URL,d);i=P(i,o);const u=await b(i);O(u)},C=(e,t)=>{let s=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(s+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(s+=`&category=${le(t.category)}`),s},le=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},P=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},de=async e=>{const t=e.target.value;l(a.LOCAL_SORT,t);const s=c(a.LOCAL_SORT),o=c(a.LOCAL_QUERY_KEY);let d=C(a.BASE_URL,o);d=P(d,s);const i=await b(d);O(i)};async function b(e){try{return(await te({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const O=async e=>{if(!e.results.length){R(r.productList);return}l(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),r.productList.innerHTML=_(e.results),F()},ue=e=>{if(e.target.value===""){const t=c(a.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,l(a.LOCAL_QUERY_KEY,t);const s=c(a.LOCAL_QUERY_KEY);g(s)}};r.form.addEventListener("submit",ie);r.categoryField.addEventListener("change",ce);r.abcField.addEventListener("change",de);r.searchField.addEventListener("input",ue);const ge=async()=>{const e=await J();if(!e.length){notFoundMarkup(r.popularProductList);return}const t=E(e),s=G(t);r.popularProductList.insertAdjacentHTML("beforeend",s)},pe=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){ae(e);return}f(e,r.popularProductList)};r.popularProductList.addEventListener("click",pe);const Le=e=>{const t=[],s=[];for(;t.length<a.NUMBER_OF_DISCOUNT;){const o=Math.floor(Math.random()*e.length);s.includes(o)||(s.push(o),t.push(e[o]))}return t},me=async()=>{const e=await V(),t=Le(e),s=E(t),o=z(s);r.dicsProd.innerHTML=o},he=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){T(e);return}f(e,r.discProdList)};r.discProdList.addEventListener("click",he);const _e=()=>{r.emailForm.addEventListener("submit",ye)},ye=e=>{e.preventDefault();const t=r.emailInput.value.trim();t&&(Ee(t),r.emailForm.reset())};async function Ee(e){const t=await Z(e);switch(t){case 201:A(r.emailForm,X);break;case 409:A(r.emailForm,W);break}return t}const x=window.matchMedia("(min-width: 768px)"),j=window.matchMedia("(min-width: 1440px)"),N=window.matchMedia("(max-width: 767.9px)"),fe=window.matchMedia("(max-width: 1439.9px)"),Ce=window.matchMedia("(min-width: 768px) and (max-width: 1439.9px)");l(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const n=c(a.LOCAL_QUERY_KEY)??[];y();oe();j.matches&&Object.keys(n).length&&(n.limit=9,l(a.LOCAL_QUERY_KEY,n),g(n));Ce.matches&&Object.keys(n).length&&(n.limit=8,l(a.LOCAL_QUERY_KEY,n),g(n));N.matches&&Object.keys(n).length&&(n.limit=6,l(a.LOCAL_QUERY_KEY,n),g(n));U(x);ge();me();_e();x.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=8,l(a.LOCAL_QUERY_KEY,n),g(n))});j.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=9,l(a.LOCAL_QUERY_KEY,n),g(n))});fe.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=8,l(a.LOCAL_QUERY_KEY,n),g(n))});N.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=6,l(a.LOCAL_QUERY_KEY,n),g(n))});
//# sourceMappingURL=commonHelpers2.js.map
