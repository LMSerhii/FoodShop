{"version":3,"file":"commonHelpers2.js","sources":["../src/js/helpers/addToCart.js","../src/js/pagination.js","../src/js/helpers/validChecked.js","../src/js/helpers/openModal.js","../src/js/products.js","../src/js/filters.js","../src/js/popular.js","../src/js/helpers/getRandomProduct.js","../src/js/dicsount_products.js","../src/js/footer.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport '../../../node_modules/izitoast/dist/css/iziToast.min.css';\nimport svg_sprite from '../../img/sprite.svg';\nimport { getDataId } from '../api_service';\nimport { save, load } from '../storage';\n\nimport { common } from '../common';\n\nconst cart = load(common.LOCAL_CART_KEY) ?? [];\n\nconst addToCart = async evt => {\n  const { id } = evt.target.closest('.js-card').dataset;\n\n  const product = await getDataId(id);\n\n  const inStorage = cart.some(({ _id }) => _id === product._id);\n\n  if (inStorage) {\n    return;\n  }\n\n  cart.push(product);\n\n  save(common.LOCAL_CART_KEY, cart);\n\n  evt.target.closest(\n    '.js-cart'\n  ).innerHTML = `<button class=\"card-btn\" type=\"button\">\n                    <svg class=\"card-btn-icon-check\" width=\"18\" height=\"18\">\n                        <use href=\"${svg_sprite}#check\"></use>\n                    </svg>\n                </button>`;\n\n  iziToast.success({\n    title: 'OK',\n    message: 'Added to cart!',\n  });\n};\n\nconst addToCartFromPopular = async evt => {\n  const { id } = evt.target.closest('.js-card').dataset;\n\n  const product = await getDataId(id);\n\n  const inStorage = cart.some(({ _id }) => _id === product._id);\n\n  if (inStorage) {\n    return;\n  }\n\n  cart.push(product);\n  save(common.LOCAL_CART_KEY, cart);\n\n  evt.target.closest(\n    '.js-cart'\n  ).innerHTML = `<button class=\"popular-btn-check\" type=\"button\">\n                    <svg class=\"popular-icon-check\" width=\"18\" height=\"18\">\n                      <use href=\"${svg_sprite}#check\"></use>\n                    </svg>\n                </button>`;\n\n  iziToast.success({\n    title: 'OK',\n    message: 'Added to cart!',\n  });\n};\n\nexport { addToCart, addToCartFromPopular };\n","import { getData } from './api_service';\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport { load, save } from './storage';\nimport { common } from './common';\nimport { refs } from './refs';\nimport { productMarkup } from './markupFunctions';\n\n// Отслеживаю вьюпорт\nlet visPagesPag;\nconst mediaQuery = window.matchMedia('(min-width: 768px)');\n\nconst handleMediaChange = event => {\n  if (event.matches) {\n    visPagesPag = 4;\n    loadPaginationDataOnChangeViewport();\n  } else {\n    visPagesPag = 2;\n    loadPaginationDataOnChangeViewport();\n  }\n};\n\nmediaQuery.addEventListener('change', handleMediaChange);\n\n//Функция создания и управления пагинацией при изменении вьюпорта\nfunction loadPaginationDataOnChangeViewport() {\n\n  const currPage = load(common.PAGES).page;\n  const currPerPage = load(common.PAGES).perPage;\n  const currTotalPage = load(common.PAGES).totalPages;\n\n  const pagination = new Pagination(refs.paginationContainer, {\n    page: currPage,\n    totalItems: currPerPage * currTotalPage,\n    itemsPerPage: currPerPage,\n    visiblePages: visPagesPag,\n    centerAlign: true,\n    firstItemClassName: 'tui-first-child',\n    lastItemClassName: 'tui-last-child',\n  });\n\n  pagination.on('beforeMove', function (eventData) {\n    const pagesData = JSON.parse(localStorage.getItem('pages'));\n    pagesData.page = eventData.page;\n    localStorage.setItem('pages', JSON.stringify(pagesData));\n    const storage_query = JSON.parse(localStorage.getItem('pages'));\n\n    const currentQuery = load(common.LOCAL_QUERY_KEY);\n    currentQuery.page = storage_query.page;\n    save(common.LOCAL_QUERY_KEY, currentQuery);\n    const query = load(common.LOCAL_QUERY_KEY);\n\n    renderProductsOnPagination(query);\n  });\n\n  const data = JSON.parse(localStorage.getItem('pages'));\n  if (data.totalPages <= 1) {\n    refs.paginationContainer.style.display = 'none';\n  } else {\n    refs.paginationContainer.style.display = 'block';\n  }\n}\n\n//Функция создания и управления пагинацией, запускается в renderProducts() и в renderProductsSort().\nexport function loadPaginationData() {\n  const pagination = new Pagination(refs.paginationContainer, {\n    page: common.INIT_QUERY.page,\n    totalItems: load('pages').perPage * load('pages').totalPages,\n    itemsPerPage: load('pages').perPage,\n    visiblePages: visPagesPag,\n    centerAlign: true,\n    firstItemClassName: 'tui-first-child',\n    lastItemClassName: 'tui-last-child',\n  });\n\n  pagination.on('beforeMove', function (eventData) {\n    const pagesData = JSON.parse(localStorage.getItem('pages'));\n    pagesData.page = eventData.page;\n    localStorage.setItem('pages', JSON.stringify(pagesData));\n    const storage_query = JSON.parse(localStorage.getItem('pages'));\n\n    const currentQuery = load(common.LOCAL_QUERY_KEY);\n    currentQuery.page = storage_query.page;\n    save(common.LOCAL_QUERY_KEY, currentQuery);\n    const query = load(common.LOCAL_QUERY_KEY);\n\n    renderProductsOnPagination(query);\n  });\n\n  const data = JSON.parse(localStorage.getItem('pages'));\n  if (data.totalPages <= 1) {\n    refs.paginationContainer.style.display = 'none';\n  } else {\n    refs.paginationContainer.style.display = 'block';\n  }\n}\n\nasync function renderProductsOnPagination(query) {\n  const data = await getData(query);\n\n  if (!data.results.length) {\n    notFoundMarkup(refs.productList);\n    return;\n  }\n\n  refs.productList.innerHTML = productMarkup(data.results);\n}\n\n// В filters.js в функции onCategoryField(), onForm(), onAbcField(), onSearchField() добавлена строка\n// \"currQuery.page = '1';\" для коректного функционирования пагинации при фильтрации.\n// в refs.js добавллен контейнер \"paginationContainer\" для пагинации.\n\nexport { handleMediaChange };\n","import { common } from '../common';\nimport { load } from '../storage';\n\nconst validChecked = products => {\n  const currentCartProducts = load(common.LOCAL_CART_KEY) ?? [];\n\n  const result = products.map(product => {\n    const isInclude = currentCartProducts.some(\n      ({ _id }) => _id === product._id\n    );\n\n    if (isInclude) {\n      product['isChecked'] = true;\n      return product;\n    } else {\n      product['isChecked'] = false;\n      return product;\n    }\n  });\n\n  return result;\n};\n\nexport { validChecked };\n","import { openModalFooter } from '../modal';\nimport { getDataId } from '../api_service';\nimport { modalProductMarkup } from './modalMarkups';\n\nconst openModal = async (evt, element) => {\n  const { id } = evt.target.closest('.js-card').dataset;\n\n  const data = await getDataId(id);\n\n  const markup = modalProductMarkup(data);\n\n  openModalFooter(element, markup);\n};\n\nexport { openModal };\n","import { common } from './common';\nimport { refs } from './refs';\nimport { getData } from './api_service';\nimport { save, load } from './storage';\nimport { addToCart } from './helpers/addToCart';\nimport { productMarkup, notFoundMarkup } from './markupFunctions';\nimport { loadPaginationData } from './pagination';\nimport { validChecked } from './helpers/validChecked';\nimport { openModal } from './helpers/openModal';\n\nconst renderProducts = async query => {\n  refs.productList.innerHTML = `<div class=\"loader-box\"><span class=\"loader\"></span></div>`;\n\n  const data = await getData(query);\n\n  if (!data.results.length) {\n    notFoundMarkup(refs.productList);\n    return;\n  }\n\n  save(common.PAGES, {\n    page: data.page,\n    perPage: data.perPage,\n    totalPages: data.totalPages,\n  });\n\n  const result = validChecked(data.results);\n\n  refs.productList.innerHTML = productMarkup(result);\n\n  loadPaginationData();\n};\n\nconst onProductList = evt => {\n  evt.preventDefault();\n\n  if (evt.currentTarget === evt.target) {\n    return;\n  }\n\n  if (evt.target.closest('.js-cart')) {\n    addToCart(evt);\n    return;\n  }\n\n  openModal(evt, refs.productList);\n};\n\nrefs.productList.addEventListener('click', onProductList);\n\nexport { renderProducts };\n","import axios from 'axios';\nimport { common } from './common';\nimport { refs } from './refs';\nimport { productMarkup, notFoundMarkup } from './markupFunctions';\nimport { getCategories } from './api_service';\nimport { save, load } from './storage';\nimport { renderProducts } from './products';\nimport { createCategoryMarkup, createSortMarkup } from './markupFunctions';\nimport SlimSelect from 'slim-select';\nimport '../../node_modules/slim-select/dist/slimselect.css';\n\nimport { loadPaginationData } from './pagination';\n\nnew SlimSelect({\n  select: '#abcField',\n  settings: {\n    showSearch: false,\n  },\n});\n\nlet categories = [];\n\nconst sortArrey = [\n  { value: 'alphabetical', label: 'A to Z' },\n  { value: 'reverse-alphabetical', label: 'Z to A' },\n  { value: 'cheap', label: 'Cheap' },\n  { value: 'expensive', label: 'Expensive' },\n  { value: 'popular', label: 'Popular' },\n  { value: 'not-popular', label: 'Not popular' },\n  { value: '', label: 'Show all' },\n];\n\nconst renderSelects = async () => {\n\n  const data = await getCategories();\n\n  categories = [...data, 'Show_all'];\n\n  const markup = createCategoryMarkup(categories);\n\n  refs.categoryField.insertAdjacentHTML('beforeend', markup);\n\n  refs.abcField.innerHTML = createSortMarkup(sortArrey);\n\n\n  new SlimSelect({\n    select: '#categoryField',\n    settings: {\n      placeholderText: 'Categories',\n      showSearch: false,\n    },\n  });\n};\n\nconst onCategoryField = async evt => {\n  const currentCategory = evt.target.value;\n  const currQuery = load(common.LOCAL_QUERY_KEY);\n  currQuery.page = '1';\n  if (currentCategory === 'Show_all') {\n    currQuery.category = null;\n  } else {\n    currQuery.category = currentCategory;\n  }\n  save(common.LOCAL_QUERY_KEY, currQuery);\n  const query = load(common.LOCAL_SORT);\n  const URL = load(common.LOCAL_QUERY_KEY);\n\n  let sortUrl = buildSortUrl(common.BASE_URL, URL);\n  sortUrl = buildSortByQuery(sortUrl, query);\n\n  const result = await get(sortUrl);\n\n  renderProductsSort(result);\n};\n\nconst onForm = async evt => {\n  evt.preventDefault();\n\n  const currentValue = refs.searchField.value;\n  const currQuery = load(common.LOCAL_QUERY_KEY);\n  currQuery.page = '1';\n  if (!currentValue) {\n    currQuery.keyword = null;\n  } else {\n    currQuery.keyword = currentValue;\n  }\n  save(common.LOCAL_QUERY_KEY, currQuery);\n  const query = load(common.LOCAL_SORT);\n  const URL = load(common.LOCAL_QUERY_KEY);\n\n  let sortUrl = buildSortUrl(common.BASE_URL, URL);\n  sortUrl = buildSortByQuery(sortUrl, query);\n\n  const result = await get(sortUrl);\n\n  renderProductsSort(result);\n};\n//2e1\nconst buildSortUrl = (baseURL, URL) => {\n  let sortUrl = `${baseURL}/products?page=${URL.page}&limit=${URL.limit}`;\n\n  if (URL.keyword) {\n    sortUrl += `&keyword=${URL.keyword}`;\n  }\n\n  if (URL.category && URL.category !== 'all') {\n    sortUrl += `&category=${formatCategory(URL.category)}`;\n  }\n\n  return sortUrl;\n};\n\nconst formatCategory = category => {\n  switch (category) {\n    case 'Meat_&_Seafood':\n      return 'Meat_%26_Seafood';\n    case 'Breads_&_Bakery':\n      return 'Breads_%26_Bakery';\n    default:\n      return category;\n  }\n};\n\nconst buildSortByQuery = (sortUrl, query) => {\n  if (query && query !== 'all') {\n    switch (query) {\n      case 'alphabetical':\n        sortUrl += `&byABC=true`;\n        break;\n      case 'reverse-alphabetical':\n        sortUrl += `&byABC=false`;\n        break;\n      case 'cheap':\n        sortUrl += `&byPrice=true`;\n        break;\n      case 'expensive':\n        sortUrl += `&byPrice=false`;\n        break;\n      case 'popular':\n        sortUrl += `&byPopularity=false`;\n        break;\n      case 'not-popular':\n        sortUrl += `&byPopularity=true`;\n        break;\n    }\n  }\n\n  return sortUrl;\n};\n\nconst onAbcField = async evt => {\n\n  const currentCategory = evt.target.value;\n  save(common.LOCAL_SORT, currentCategory);\n  const query = load(common.LOCAL_SORT);\n  const URL = load(common.LOCAL_QUERY_KEY);\n\n  let sortUrl = buildSortUrl(common.BASE_URL, URL);\n  sortUrl = buildSortByQuery(sortUrl, query);\n\n  const result = await get(sortUrl);\n\n  renderProductsSort(result);\n\n};\n\n//wfw\nasync function get(sortUrl) {\n  try {\n    const response = await axios({\n      url: `${sortUrl}`,\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error('Error:', error);\n    return error;\n  }\n}\n\nconst renderProductsSort = async result => {\n  if (!result.results.length) {\n    notFoundMarkup(refs.productList);\n    return;\n  }\n  save(common.PAGES, {\n    page: result.page,\n    perPage: result.perPage,\n    totalPages: result.totalPages,\n  });\n  refs.productList.innerHTML = productMarkup(result.results);\n  loadPaginationData();\n};\n\nconst onSearchField = evt => {\n  if (evt.target.value === '') {\n    const currentQuery = load(common.LOCAL_QUERY_KEY);\n    currentQuery.page = '1';\n    currentQuery.keyword = null;\n    save(common.LOCAL_QUERY_KEY, currentQuery);\n    const query = load(common.LOCAL_QUERY_KEY);\n    renderProducts(query);\n  }\n};\n\nrefs.form.addEventListener('submit', onForm);\nrefs.categoryField.addEventListener('change', onCategoryField);\nrefs.abcField.addEventListener('change', onAbcField);\nrefs.searchField.addEventListener('input', onSearchField);\n\nexport { renderSelects };\n","import { common } from './common';\nimport { refs } from './refs';\nimport { getPopular } from './api_service';\nimport { save, load } from './storage';\nimport { createMarkupPopular } from './markupFunctions';\nimport { addToCartFromPopular } from './helpers/addToCart';\nimport { validChecked } from './helpers/validChecked';\nimport { openModal } from './helpers/openModal';\n\nconst renderPopular = async () => {\n  const response = await getPopular();\n  if (!response.length) {\n    notFoundMarkup(refs.popularProductList);\n    return;\n  }\n\n  const results = validChecked(response);\n\n  const markup = createMarkupPopular(results);\n  refs.popularProductList.insertAdjacentHTML('beforeend', markup);\n};\n\nconst onPopularList = evt => {\n  evt.preventDefault();\n\n  if (evt.target.closest('.js-cart')) {\n    addToCartFromPopular(evt);\n    return;\n  }\n\n  openModal(evt, refs.popularProductList);\n};\n\nrefs.popularProductList.addEventListener('click', onPopularList);\n\nexport { renderPopular };\n","import { common } from '../common';\n\nconst getRandomProduct = arrey => {\n  const listRandomCards = [];\n  const additionalList = [];\n\n  while (listRandomCards.length < common.NUMBER_OF_DISCOUNT) {\n    const randomNumber = Math.floor(Math.random() * arrey.length);\n    if (additionalList.includes(randomNumber)) {\n      continue;\n    }\n    additionalList.push(randomNumber);\n    listRandomCards.push(arrey[randomNumber]);\n  }\n\n  return listRandomCards;\n};\n\nexport { getRandomProduct };\n","import { getDiscount } from './api_service';\nimport { refs } from './refs';\nimport { createDiscountMarkup } from './markupFunctions';\nimport { addToCart } from './helpers/addToCart';\nimport { getRandomProduct } from './helpers/getRandomProduct';\nimport { validChecked } from './helpers/validChecked';\nimport { openModal } from './helpers/openModal';\n\n// fetch data\nconst dataDiscountProd = async () => {\n  const data = await getDiscount();\n  const randomProducts = getRandomProduct(data);\n\n  const result = validChecked(randomProducts);\n\n  const markup = createDiscountMarkup(result);\n  refs.dicsProd.innerHTML = markup;\n};\n\n// add to ul\n\n// add listner to products\n\nconst clickOnDiscount = evt => {\n  evt.preventDefault();\n\n  if (evt.target.closest('.js-cart')) {\n    addToCart(evt);\n    return;\n  }\n\n  openModal(evt, refs.discProdList);\n};\n\nrefs.discProdList.addEventListener('click', clickOnDiscount);\n\nexport { dataDiscountProd };\n","import { createSubscription } from './api_service';\nimport { openModalFooter } from './modal';\nimport { refs } from './refs';\nimport { success, error } from './helpers/modalMarkups';\n\nconst renderFooter = () => {\n  refs.emailForm.addEventListener('submit', onEmailEnter);\n};\n\nconst onEmailEnter = event => {\n  event.preventDefault();\n\n  const email = refs.emailInput.value.trim();\n  if (!email) {\n    return;\n  }\n  onSendBtn(email);\n};\n\nasync function onSendBtn(email) {\n  const result = await createSubscription(email);\n  switch (result) {\n    case 201:\n      openModalFooter(refs.emailForm, success);\n      break;\n    case 409:\n      openModalFooter(refs.emailForm, error);\n      break;\n\n    default:\n      break;\n  }\n  return result;\n}\n\nexport { renderFooter };\n","import { renderProducts } from './js/products';\nimport { save, load } from './js/storage';\nimport { common } from './js/common';\nimport { renderSelects } from './js/filters';\nimport { renderPopular } from './js/popular';\nimport { dataDiscountProd } from './js/dicsount_products';\nimport { renderFooter } from './js/footer';\nimport { handleMediaChange } from './js/pagination';\n\nconst mediaQuery_min768 = window.matchMedia('(min-width: 768px)');\nconst mediaQuery_min1440 = window.matchMedia('(min-width: 1440px)');\nconst mediaQuery_max768 = window.matchMedia('(max-width: 767.9px)');\nconst mediaQuery_max1440 = window.matchMedia('(max-width: 1439.9px)');\nconst mediaQuery_min768_max1440 = window.matchMedia(\n  '(min-width: 768px) and (max-width: 1439.9px)'\n);\n\nsave(common.LOCAL_QUERY_KEY, common.INIT_QUERY);\n\nconst storage_query = load(common.LOCAL_QUERY_KEY) ?? [];\n\nrenderSelects();\n\nif (mediaQuery_min1440.matches) {\n  if (Object.keys(storage_query).length) {\n    storage_query.limit = 9;\n    save(common.LOCAL_QUERY_KEY, storage_query);\n    renderProducts(storage_query);\n  }\n}\n\nif (mediaQuery_min768_max1440.matches) {\n  if (Object.keys(storage_query).length) {\n    storage_query.limit = 8;\n    save(common.LOCAL_QUERY_KEY, storage_query);\n    renderProducts(storage_query);\n  }\n}\n\nif (mediaQuery_max768.matches) {\n  if (Object.keys(storage_query).length) {\n    storage_query.limit = 6;\n    save(common.LOCAL_QUERY_KEY, storage_query);\n    renderProducts(storage_query);\n  }\n}\n\nhandleMediaChange(mediaQuery_min768);\nrenderPopular();\ndataDiscountProd();\nrenderFooter();\n\nmediaQuery_min768.addListener(mediaQueryList => {\n  if (mediaQueryList.matches) {\n    if (Object.keys(storage_query).length) {\n      storage_query.limit = 8;\n      save(common.LOCAL_QUERY_KEY, storage_query);\n      renderProducts(storage_query);\n    }\n  }\n});\n\nmediaQuery_min1440.addListener(mediaQueryList => {\n  if (mediaQueryList.matches) {\n    if (Object.keys(storage_query).length) {\n      storage_query.limit = 9;\n      save(common.LOCAL_QUERY_KEY, storage_query);\n      renderProducts(storage_query);\n    }\n  }\n});\n\nmediaQuery_max1440.addListener(mediaQueryList => {\n  if (mediaQueryList.matches) {\n    if (Object.keys(storage_query).length) {\n      storage_query.limit = 8;\n      save(common.LOCAL_QUERY_KEY, storage_query);\n      renderProducts(storage_query);\n    }\n  }\n});\n\nmediaQuery_max768.addListener(mediaQueryList => {\n  if (mediaQueryList.matches) {\n    if (Object.keys(storage_query).length) {\n      storage_query.limit = 6;\n      save(common.LOCAL_QUERY_KEY, storage_query);\n      renderProducts(storage_query);\n    }\n  }\n});\n"],"names":["cart","load","common","addToCart","evt","id","product","getDataId","_id","save","svg_sprite","iziToast","addToCartFromPopular","visPagesPag","mediaQuery","handleMediaChange","event","loadPaginationDataOnChangeViewport","currPage","currPerPage","currTotalPage","Pagination","refs","eventData","pagesData","storage_query","currentQuery","query","renderProductsOnPagination","loadPaginationData","data","getData","productMarkup","validChecked","products","currentCartProducts","openModal","element","markup","modalProductMarkup","openModalFooter","renderProducts","notFoundMarkup","result","onProductList","SlimSelect","categories","sortArrey","renderSelects","getCategories","createCategoryMarkup","createSortMarkup","onCategoryField","currentCategory","currQuery","URL","sortUrl","buildSortUrl","buildSortByQuery","get","renderProductsSort","onForm","currentValue","baseURL","formatCategory","category","onAbcField","axios","error","onSearchField","renderPopular","response","getPopular","results","createMarkupPopular","onPopularList","getRandomProduct","arrey","listRandomCards","additionalList","randomNumber","dataDiscountProd","getDiscount","randomProducts","createDiscountMarkup","clickOnDiscount","renderFooter","onEmailEnter","email","onSendBtn","createSubscription","success","mediaQuery_min768","mediaQuery_min1440","mediaQuery_max768","mediaQuery_max1440","mediaQuery_min768_max1440","mediaQueryList"],"mappings":"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"}