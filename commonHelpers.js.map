{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart.js"],"sourcesContent":["import { load, save, remove } from './storage';\nimport { common } from './common';\nimport { producCartMarkup } from './markupFunctions';\nimport { refs } from './refs';\n\nconst cart = load(common.LOCAL_CART_KEY) ?? [];\n\nconst renderItemCount = () => {\n  const itemCount = cart.length;\n  console.log(`Item Count: ${itemCount}`);\n  refs.productsCount.textContent = `(${itemCount})`;\n};\n\nconst validClose = productId => {\n  const index = cart.findIndex(({ _id }) => _id === productId);\n\n  console.log(index);\n\n  cart.splice(index, 1);\n\n  remove(common.LOCAL_CART_KEY);\n\n  save(common.LOCAL_CART_KEY, cart);\n\n  refs.cartList.innerHTML = producCartMarkup(cart);\n  renderTotalAmount(); // Оновлення суми при видаленні товару\n  renderItemCount();\n};\n\nconst onClose = evt => {\n  if (evt.currentTarget === evt.target) {\n    return;\n  }\n\n  const id = evt.target.closest('.js-card').dataset.id;\n  console.log(evt.target);\n\n  if (evt.target.classList.contains('js-close')) {\n    validClose(id);\n  }\n};\n\nconst renderTotalAmount = () => {\n  const totalAmount = cart\n    .reduce((acc, product) => acc + product.price, 0)\n    .toFixed(2);\n  refs.totalAmountDisplay.textContent = `$${totalAmount}`;\n};\n\n// Функція для очищення значення ключа \"cart\" у локальному сховищі\nconst clearCartLocalStorage = () => {\n  localStorage.setItem('cart', '[]');\n  location.reload();\n};\n\nconst renderCart = () => {\n  if (cart.length > 3) {\n    // Застосування вертикального скролу\n    refs.cartList.classList.add('scrollable');\n  }\n\n  refs.cartList.innerHTML = producCartMarkup(cart);\n  refs.cartList.addEventListener('click', onClose);\n  renderTotalAmount();\n};\n\nrenderItemCount();\nrenderCart();\n\n// Додавання обробника подій для кнопки \"Delete all\"\nrefs.deleteAllButton.addEventListener('click', clearCartLocalStorage);\n"],"names":["cart","load","common","renderItemCount","itemCount","refs","validClose","productId","index","_id","remove","save","producCartMarkup","renderTotalAmount","onClose","evt","id","totalAmount","acc","product","clearCartLocalStorage","renderCart"],"mappings":"iFAKA,MAAMA,EAAOC,EAAKC,EAAO,cAAc,GAAK,CAAA,EAEtCC,EAAkB,IAAM,CAC5B,MAAMC,EAAYJ,EAAK,OACvB,QAAQ,IAAI,eAAeI,GAAW,EACtCC,EAAK,cAAc,YAAc,IAAID,IACvC,EAEME,EAAaC,GAAa,CAC9B,MAAMC,EAAQR,EAAK,UAAU,CAAC,CAAE,IAAAS,KAAUA,IAAQF,CAAS,EAE3D,QAAQ,IAAIC,CAAK,EAEjBR,EAAK,OAAOQ,EAAO,CAAC,EAEpBE,EAAOR,EAAO,cAAc,EAE5BS,EAAKT,EAAO,eAAgBF,CAAI,EAEhCK,EAAK,SAAS,UAAYO,EAAiBZ,CAAI,EAC/Ca,IACAV,GACF,EAEMW,EAAUC,GAAO,CACrB,GAAIA,EAAI,gBAAkBA,EAAI,OAC5B,OAGF,MAAMC,EAAKD,EAAI,OAAO,QAAQ,UAAU,EAAE,QAAQ,GAClD,QAAQ,IAAIA,EAAI,MAAM,EAElBA,EAAI,OAAO,UAAU,SAAS,UAAU,GAC1CT,EAAWU,CAAE,CAEjB,EAEMH,EAAoB,IAAM,CAC9B,MAAMI,EAAcjB,EACjB,OAAO,CAACkB,EAAKC,IAAYD,EAAMC,EAAQ,MAAO,CAAC,EAC/C,QAAQ,CAAC,EACZd,EAAK,mBAAmB,YAAc,IAAIY,GAC5C,EAGMG,EAAwB,IAAM,CAClC,aAAa,QAAQ,OAAQ,IAAI,EACjC,SAAS,OAAM,CACjB,EAEMC,EAAa,IAAM,CACnBrB,EAAK,OAAS,GAEhBK,EAAK,SAAS,UAAU,IAAI,YAAY,EAG1CA,EAAK,SAAS,UAAYO,EAAiBZ,CAAI,EAC/CK,EAAK,SAAS,iBAAiB,QAASS,CAAO,EAC/CD,GACF,EAEAV,IACAkB,IAGAhB,EAAK,gBAAgB,iBAAiB,QAASe,CAAqB"}