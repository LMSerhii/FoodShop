import{c as a,l as s,s as n,b as f,r as o,n as g,d as y,e as A,f as b,g as C,h as P}from"./assets/refs-8c3bfa97.js";import{a as u}from"./assets/vendor-b325e1ef.js";async function Y(e){try{return(await u({url:`${a.BASE_URL}/products`,method:"GET",header:{"Content-Type":"aplication/json"},params:e})).data}catch(t){return t}}async function k(e){try{return(await u({url:`${a.BASE_URL}/products/${e}`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(t){return t}}async function m(e){try{let t=null;return e&&(t={limit:e}),(await u({url:`${a.BASE_URL}/products/popular`,method:"GET",header:{"Content-Type":"aplication/json"},params:t})).data}catch(t){return t}}async function R(){try{return(await u({url:`${a.BASE_URL}/products/discount`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}async function T(){try{return(await u({url:`${a.BASE_URL}/products/categories`,method:"GET",header:{"Content-Type":"aplication/json"}})).data}catch(e){return e}}const p=s(a.LOCAL_CART_KEY)??[],E=async e=>{const{id:t}=e.target.closest(".js-card").dataset,r=await k(t);p.some(({_id:i})=>i===r._id)||(p.push(r),n(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="btn-check js-cart" type="button">
   <svg class="icon-check" width="18" height="18">
                               <use href="${f}#check"></use>
                           </svg>
                         </button>`)},l=async e=>{const t=await Y(e);if(!t.results.length){g(o.productList);return}n(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages}),o.productList.innerHTML=y(t.results)},S=e=>{e.preventDefault(),e.target.closest(".js-cart")&&E(e),e.target.classList.contains("js-info")&&openModal(e)};o.productList.addEventListener("click",S);let L=[];const v=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],U=async()=>{L=[...await T(),"Show_all"];const t=A(L);o.categoryField.insertAdjacentHTML("beforeend",t),o.abcField.innerHTML=b(v)},w=e=>{const t=e.target.value,r=s(a.LOCAL_QUERY_KEY);t==="Show_all"?r.category=null:r.category=t,n(a.LOCAL_QUERY_KEY,r);const c=s(a.LOCAL_QUERY_KEY);l(c)},Q=e=>{e.preventDefault();const t=o.searchField.value,r=s(a.LOCAL_QUERY_KEY);t?r.keyword=t:r.keyword=null,n(a.LOCAL_QUERY_KEY,r);const c=s(a.LOCAL_QUERY_KEY);l(c)},O=async e=>{const t=e.target.value,r=s(a.LOCAL_QUERY_KEY);r.sort=t,n(a.LOCAL_QUERY_KEY,r);const c=s(a.LOCAL_QUERY_KEY),i=c.sort,h=K(i),_=await M(c,h);j(_)},K=e=>{let t={};switch(e){case"alphabetical":t="&byABC=true";break;case"reverse-alphabetical":t="&byABC=false";break;case"cheap":t="&byPrice=true";break;case"expensive":t="&byPrice=false";break;case"popular":t="&byPopularity=false";break;case"not-popular":t="&byPopularity=true";break}return t};async function M(e,t){try{return(await u({url:`${a.BASE_URL}/products?${t}`,method:"GET",header:{"Content-Type":"application/json"},params:e})).data}catch(r){return r}}const j=async e=>{if(!e.results.length){g(o.productList);return}n(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),o.productList.innerHTML=y(e.results)},F=e=>{if(e.target.value===""){const t=s(a.LOCAL_QUERY_KEY);t.keyword=null,n(a.LOCAL_QUERY_KEY,t);const r=s(a.LOCAL_QUERY_KEY);l(r)}};o.form.addEventListener("submit",Q);o.categoryField.addEventListener("change",w);o.abcField.addEventListener("change",O);o.searchField.addEventListener("input",F);const d=document.querySelector(".popular_products_list");console.dir(d);d.addEventListener("click",D);async function $(){const e=await m();if(!e.length){notFoundMarkup(o.popularProductList);return}n(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages});const t=C(e);d.insertAdjacentHTML("beforeend",t)}function D(e){e.preventDefault(),e.target.closest(".js-cart")&&E(e),e.target.classList.contains("js-info")&&openModal(e)}const G=async()=>{const e=await R(),t=P(e.slice(0,2));o.dicsProd.innerHTML=t},B=()=>{};o.discProdList.addEventListener("click",B());n(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const q=s(a.LOCAL_QUERY_KEY)??[];U();l(q);$();G();
//# sourceMappingURL=commonHelpers2.js.map
