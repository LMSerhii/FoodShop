import{l as c,c as a,g as h,s as i,f as S,r,h as k,i as _,o as m,m as B,n as Q,j as H,k as $,q,t as J,u as G,v as V,w as z,x as Z,y as W,z as X}from"./assets/modalMarkups-cb0ad4a8.js";import{i as R,P as M,S as v,a as ee}from"./assets/vendor-85c19974.js";const y=()=>{const e=document.querySelector("#product-count-header"),t=c(a.LOCAL_CART_KEY)??[];e.innerHTML=`(${t.length})`},p=c(a.LOCAL_CART_KEY)??[],K=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await h(t);p.some(({_id:l})=>l===s._id)||(p.push(s),i(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="card-btn" type="button">
                    <svg class="card-btn-icon-check" width="18" height="18">
                        <use href="${S}#check"></use>
                    </svg>
                </button>`,y(),R.success({title:"OK",message:"Added to cart!"}))},te=async e=>{const{id:t}=e.target.closest(".js-card").dataset,s=await h(t);p.some(({_id:l})=>l===s._id)||(p.push(s),i(a.LOCAL_CART_KEY,p),e.target.closest(".js-cart").innerHTML=`<button class="popular-btn-check" type="button">
                    <svg class="popular-icon-check" width="18" height="18">
                      <use href="${S}#check"></use>
                    </svg>
                </button>`,y(),R.success({title:"OK",message:"Added to cart!"}))};let L;const ae=window.matchMedia("(min-width: 768px)"),T=e=>{e.matches?(L=4,Y()):(L=2,Y())};ae.addEventListener("change",T);function Y(){const e=c(a.PAGES).page,t=c(a.PAGES).perPage,s=c(a.PAGES).totalPages;new M(r.paginationContainer,{page:e,totalItems:t*s,itemsPerPage:t,visiblePages:L,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(u){const d=JSON.parse(localStorage.getItem("pages"));d.page=u.page,localStorage.setItem("pages",JSON.stringify(d));const N=JSON.parse(localStorage.getItem("pages")),A=c(a.LOCAL_QUERY_KEY);A.page=N.page,i(a.LOCAL_QUERY_KEY,A);const D=c(a.LOCAL_QUERY_KEY);I(D)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}function U(){new M(r.paginationContainer,{page:a.INIT_QUERY.page,totalItems:c("pages").perPage*c("pages").totalPages,itemsPerPage:c("pages").perPage,visiblePages:L,centerAlign:!0,firstItemClassName:"tui-first-child",lastItemClassName:"tui-last-child"}).on("beforeMove",function(s){const o=JSON.parse(localStorage.getItem("pages"));o.page=s.page,localStorage.setItem("pages",JSON.stringify(o));const l=JSON.parse(localStorage.getItem("pages")),u=c(a.LOCAL_QUERY_KEY);u.page=l.page,i(a.LOCAL_QUERY_KEY,u);const d=c(a.LOCAL_QUERY_KEY);I(d)}),JSON.parse(localStorage.getItem("pages")).totalPages<=1?r.paginationContainer.style.display="none":r.paginationContainer.style.display="block"}async function I(e){const t=await k(e);if(!t.results.length){notFoundMarkup(r.productList);return}r.productList.innerHTML=_(t.results)}const E=e=>{const t=c(a.LOCAL_CART_KEY)??[];return e.map(o=>t.some(({_id:u})=>u===o._id)?(o.isChecked=!0,o):(o.isChecked=!1,o))},f=async(e,t)=>{const{id:s}=e.target.closest(".js-card").dataset,o=await h(s),l=B(o);m(t,l)},g=async e=>{r.productList.innerHTML='<div class="loader-box"><span class="loader"></span></div>';const t=await k(e);if(!t.results.length){Q(r.productList);return}i(a.PAGES,{page:t.page,perPage:t.perPage,totalPages:t.totalPages});const s=E(t.results);r.productList.innerHTML=_(s),U()},se=e=>{if(e.preventDefault(),e.currentTarget!==e.target){if(e.target.closest(".js-cart")){K(e);return}f(e,r.productList)}};r.productList.addEventListener("click",se);new v({select:"#abcField",settings:{showSearch:!1}});let w=[];const re=[{value:"alphabetical",label:"A to Z"},{value:"reverse-alphabetical",label:"Z to A"},{value:"cheap",label:"Cheap"},{value:"expensive",label:"Expensive"},{value:"popular",label:"Popular"},{value:"not-popular",label:"Not popular"},{value:"",label:"Show all"}],ne=async()=>{w=[...await H(),"Show_all"];const t=$(w);r.categoryField.insertAdjacentHTML("beforeend",t),r.abcField.innerHTML=q(re),new v({select:"#categoryField",settings:{placeholderText:"Categories",showSearch:!1}})},oe=async e=>{const t=e.target.value,s=c(a.LOCAL_QUERY_KEY);s.page="1",t==="Show_all"?s.category=null:s.category=t,i(a.LOCAL_QUERY_KEY,s);const o=c(a.LOCAL_SORT),l=c(a.LOCAL_QUERY_KEY);let u=C(a.BASE_URL,l);u=P(u,o);const d=await b(u);O(d)},ce=async e=>{e.preventDefault();const t=r.searchField.value,s=c(a.LOCAL_QUERY_KEY);s.page="1",t?s.keyword=t:s.keyword=null,i(a.LOCAL_QUERY_KEY,s);const o=c(a.LOCAL_SORT),l=c(a.LOCAL_QUERY_KEY);let u=C(a.BASE_URL,l);u=P(u,o);const d=await b(u);O(d)},C=(e,t)=>{let s=`${e}/products?page=${t.page}&limit=${t.limit}`;return t.keyword&&(s+=`&keyword=${t.keyword}`),t.category&&t.category!=="all"&&(s+=`&category=${ie(t.category)}`),s},ie=e=>{switch(e){case"Meat_&_Seafood":return"Meat_%26_Seafood";case"Breads_&_Bakery":return"Breads_%26_Bakery";default:return e}},P=(e,t)=>{if(t&&t!=="all")switch(t){case"alphabetical":e+="&byABC=true";break;case"reverse-alphabetical":e+="&byABC=false";break;case"cheap":e+="&byPrice=true";break;case"expensive":e+="&byPrice=false";break;case"popular":e+="&byPopularity=false";break;case"not-popular":e+="&byPopularity=true";break}return e},le=async e=>{const t=e.target.value;i(a.LOCAL_SORT,t);const s=c(a.LOCAL_SORT),o=c(a.LOCAL_QUERY_KEY);let l=C(a.BASE_URL,o);l=P(l,s);const u=await b(l);O(u)};async function b(e){try{return(await ee({url:`${e}`,method:"GET",headers:{"Content-Type":"application/json"}})).data}catch(t){return console.error("Error:",t),t}}const O=async e=>{if(!e.results.length){Q(r.productList);return}i(a.PAGES,{page:e.page,perPage:e.perPage,totalPages:e.totalPages}),r.productList.innerHTML=_(e.results),U()},ue=e=>{if(e.target.value===""){const t=c(a.LOCAL_QUERY_KEY);t.page="1",t.keyword=null,i(a.LOCAL_QUERY_KEY,t);const s=c(a.LOCAL_QUERY_KEY);g(s)}};r.form.addEventListener("submit",ce);r.categoryField.addEventListener("change",oe);r.abcField.addEventListener("change",le);r.searchField.addEventListener("input",ue);const de=async()=>{const e=await J();if(!e.length){notFoundMarkup(r.popularProductList);return}const t=E(e),s=G(t);r.popularProductList.insertAdjacentHTML("beforeend",s)},ge=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){te(e);return}f(e,r.popularProductList)};r.popularProductList.addEventListener("click",ge);const pe=e=>{const t=[],s=[];for(;t.length<a.NUMBER_OF_DISCOUNT;){const o=Math.floor(Math.random()*e.length);s.includes(o)||(s.push(o),t.push(e[o]))}return t},Le=async()=>{const e=await V(),t=pe(e),s=E(t),o=z(s);r.dicsProd.innerHTML=o},me=e=>{if(e.preventDefault(),e.target.closest(".js-cart")){K(e);return}f(e,r.discProdList)};r.discProdList.addEventListener("click",me);const he=()=>{r.emailForm.addEventListener("submit",_e)},_e=e=>{e.preventDefault();const t=r.emailInput.value.trim();t&&ye(t)};async function ye(e){const t=await Z(e);switch(t){case 201:m(r.emailForm,X);break;case 409:m(r.emailForm,W);break}return t}const F=window.matchMedia("(min-width: 768px)"),x=window.matchMedia("(min-width: 1440px)"),j=window.matchMedia("(max-width: 767.9px)"),Ee=window.matchMedia("(max-width: 1439.9px)"),fe=window.matchMedia("(min-width: 768px) and (max-width: 1439.9px)");i(a.LOCAL_QUERY_KEY,a.INIT_QUERY);const n=c(a.LOCAL_QUERY_KEY)??[];y();ne();x.matches&&Object.keys(n).length&&(n.limit=9,i(a.LOCAL_QUERY_KEY,n),g(n));fe.matches&&Object.keys(n).length&&(n.limit=8,i(a.LOCAL_QUERY_KEY,n),g(n));j.matches&&Object.keys(n).length&&(n.limit=6,i(a.LOCAL_QUERY_KEY,n),g(n));T(F);de();Le();he();F.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=8,i(a.LOCAL_QUERY_KEY,n),g(n))});x.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=9,i(a.LOCAL_QUERY_KEY,n),g(n))});Ee.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=8,i(a.LOCAL_QUERY_KEY,n),g(n))});j.addListener(e=>{e.matches&&Object.keys(n).length&&(n.limit=6,i(a.LOCAL_QUERY_KEY,n),g(n))});
//# sourceMappingURL=commonHelpers2.js.map
